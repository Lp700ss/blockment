{"ast":null,"code":"/**\n * \"Client\" wraps \"ws\" or a browser-implemented \"WebSocket\" library\n * according to the environment providing JSON RPC 2.0 support on top.\n * @module Client\n */\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _eventemitter = require(\"eventemitter3\");\n\nvar _circularJson = _interopRequireDefault(require(\"circular-json\"));\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = (0, _getPrototypeOf2[\"default\"])(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2[\"default\"])(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2[\"default\"])(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar __rest = void 0 && (void 0).__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}; // @ts-ignore\n\n\nvar CommonClient = /*#__PURE__*/function (_EventEmitter) {\n  (0, _inherits2[\"default\"])(CommonClient, _EventEmitter);\n\n  var _super = _createSuper(CommonClient);\n  /**\n   * Instantiate a Client class.\n   * @constructor\n   * @param {webSocketFactory} webSocketFactory - factory method for WebSocket\n   * @param {String} address - url to a websocket server\n   * @param {Object} options - ws options object with reconnect parameters\n   * @param {Function} generate_request_id - custom generation request Id\n   * @return {CommonClient}\n   */\n\n\n  function CommonClient(webSocketFactory) {\n    var _this;\n\n    var address = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"ws://localhost:8080\";\n\n    var _a = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    var generate_request_id = arguments.length > 3 ? arguments[3] : undefined;\n    (0, _classCallCheck2[\"default\"])(this, CommonClient);\n\n    var _a$autoconnect = _a.autoconnect,\n        autoconnect = _a$autoconnect === void 0 ? true : _a$autoconnect,\n        _a$reconnect = _a.reconnect,\n        reconnect = _a$reconnect === void 0 ? true : _a$reconnect,\n        _a$reconnect_interval = _a.reconnect_interval,\n        reconnect_interval = _a$reconnect_interval === void 0 ? 1000 : _a$reconnect_interval,\n        _a$max_reconnects = _a.max_reconnects,\n        max_reconnects = _a$max_reconnects === void 0 ? 5 : _a$max_reconnects,\n        rest_options = __rest(_a, [\"autoconnect\", \"reconnect\", \"reconnect_interval\", \"max_reconnects\"]);\n\n    _this = _super.call(this);\n    _this.webSocketFactory = webSocketFactory;\n    _this.queue = {};\n    _this.rpc_id = 0;\n    _this.address = address;\n    _this.autoconnect = autoconnect;\n    _this.ready = false;\n    _this.reconnect = reconnect;\n    _this.reconnect_interval = reconnect_interval;\n    _this.max_reconnects = max_reconnects;\n    _this.rest_options = rest_options;\n    _this.current_reconnects = 0;\n\n    _this.generate_request_id = generate_request_id || function () {\n      return ++_this.rpc_id;\n    };\n\n    if (_this.autoconnect) _this._connect(_this.address, Object.assign({\n      autoconnect: _this.autoconnect,\n      reconnect: _this.reconnect,\n      reconnect_interval: _this.reconnect_interval,\n      max_reconnects: _this.max_reconnects\n    }, _this.rest_options));\n    return _this;\n  }\n  /**\n   * Connects to a defined server if not connected already.\n   * @method\n   * @return {Undefined}\n   */\n\n\n  (0, _createClass2[\"default\"])(CommonClient, [{\n    key: \"connect\",\n    value: function connect() {\n      if (this.socket) return;\n\n      this._connect(this.address, Object.assign({\n        autoconnect: this.autoconnect,\n        reconnect: this.reconnect,\n        reconnect_interval: this.reconnect_interval,\n        max_reconnects: this.max_reconnects\n      }, this.rest_options));\n    }\n    /**\n     * Calls a registered RPC method on server.\n     * @method\n     * @param {String} method - RPC method name\n     * @param {Object|Array} params - optional method parameters\n     * @param {Number} timeout - RPC reply timeout value\n     * @param {Object} ws_opts - options passed to ws\n     * @return {Promise}\n     */\n\n  }, {\n    key: \"call\",\n    value: function call(method, params, timeout, ws_opts) {\n      var _this2 = this;\n\n      if (!ws_opts && \"object\" === (0, _typeof2[\"default\"])(timeout)) {\n        ws_opts = timeout;\n        timeout = null;\n      }\n\n      return new Promise(function (resolve, reject) {\n        if (!_this2.ready) return reject(new Error(\"socket not ready\"));\n\n        var rpc_id = _this2.generate_request_id(method, params);\n\n        var message = {\n          jsonrpc: \"2.0\",\n          method: method,\n          params: params || null,\n          id: rpc_id\n        };\n\n        _this2.socket.send(JSON.stringify(message), ws_opts, function (error) {\n          if (error) return reject(error);\n          _this2.queue[rpc_id] = {\n            promise: [resolve, reject]\n          };\n\n          if (timeout) {\n            _this2.queue[rpc_id].timeout = setTimeout(function () {\n              delete _this2.queue[rpc_id];\n              reject(new Error(\"reply timeout\"));\n            }, timeout);\n          }\n        });\n      });\n    }\n    /**\n     * Logins with the other side of the connection.\n     * @method\n     * @param {Object} params - Login credentials object\n     * @return {Promise}\n     */\n\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(params) {\n        var resp;\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.call(\"rpc.login\", params);\n\n              case 2:\n                resp = _context.sent;\n\n                if (resp) {\n                  _context.next = 5;\n                  break;\n                }\n\n                throw new Error(\"authentication failed\");\n\n              case 5:\n                return _context.abrupt(\"return\", resp);\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function login(_x) {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n    /**\n     * Fetches a list of client's methods registered on server.\n     * @method\n     * @return {Array}\n     */\n\n  }, {\n    key: \"listMethods\",\n    value: function () {\n      var _listMethods = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee2() {\n        return _regenerator[\"default\"].wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.call(\"__listMethods\");\n\n              case 2:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function listMethods() {\n        return _listMethods.apply(this, arguments);\n      }\n\n      return listMethods;\n    }()\n    /**\n     * Sends a JSON-RPC 2.0 notification to server.\n     * @method\n     * @param {String} method - RPC method name\n     * @param {Object} params - optional method parameters\n     * @return {Promise}\n     */\n\n  }, {\n    key: \"notify\",\n    value: function notify(method, params) {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (!_this3.ready) return reject(new Error(\"socket not ready\"));\n        var message = {\n          jsonrpc: \"2.0\",\n          method: method,\n          params: params || null\n        };\n\n        _this3.socket.send(JSON.stringify(message), function (error) {\n          if (error) return reject(error);\n          resolve();\n        });\n      });\n    }\n    /**\n     * Subscribes for a defined event.\n     * @method\n     * @param {String|Array} event - event name\n     * @return {Undefined}\n     * @throws {Error}\n     */\n\n  }, {\n    key: \"subscribe\",\n    value: function () {\n      var _subscribe = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee3(event) {\n        var result;\n        return _regenerator[\"default\"].wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (typeof event === \"string\") event = [event];\n                _context3.next = 3;\n                return this.call(\"rpc.on\", event);\n\n              case 3:\n                result = _context3.sent;\n\n                if (!(typeof event === \"string\" && result[event] !== \"ok\")) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                throw new Error(\"Failed subscribing to an event '\" + event + \"' with: \" + result[event]);\n\n              case 6:\n                return _context3.abrupt(\"return\", result);\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function subscribe(_x2) {\n        return _subscribe.apply(this, arguments);\n      }\n\n      return subscribe;\n    }()\n    /**\n     * Unsubscribes from a defined event.\n     * @method\n     * @param {String|Array} event - event name\n     * @return {Undefined}\n     * @throws {Error}\n     */\n\n  }, {\n    key: \"unsubscribe\",\n    value: function () {\n      var _unsubscribe = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee4(event) {\n        var result;\n        return _regenerator[\"default\"].wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (typeof event === \"string\") event = [event];\n                _context4.next = 3;\n                return this.call(\"rpc.off\", event);\n\n              case 3:\n                result = _context4.sent;\n\n                if (!(typeof event === \"string\" && result[event] !== \"ok\")) {\n                  _context4.next = 6;\n                  break;\n                }\n\n                throw new Error(\"Failed unsubscribing from an event with: \" + result);\n\n              case 6:\n                return _context4.abrupt(\"return\", result);\n\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function unsubscribe(_x3) {\n        return _unsubscribe.apply(this, arguments);\n      }\n\n      return unsubscribe;\n    }()\n    /**\n     * Closes a WebSocket connection gracefully.\n     * @method\n     * @param {Number} code - socket close code\n     * @param {String} data - optional data to be sent before closing\n     * @return {Undefined}\n     */\n\n  }, {\n    key: \"close\",\n    value: function close(code, data) {\n      this.socket.close(code || 1000, data);\n    }\n    /**\n     * Connection/Message handler.\n     * @method\n     * @private\n     * @param {String} address - WebSocket API address\n     * @param {Object} options - ws options object\n     * @return {Undefined}\n     */\n\n  }, {\n    key: \"_connect\",\n    value: function _connect(address, options) {\n      var _this4 = this;\n\n      this.socket = this.webSocketFactory(address, options);\n      this.socket.addEventListener(\"open\", function () {\n        _this4.ready = true;\n\n        _this4.emit(\"open\");\n\n        _this4.current_reconnects = 0;\n      });\n      this.socket.addEventListener(\"message\", function (_ref) {\n        var message = _ref.data;\n        if (message instanceof ArrayBuffer) message = Buffer.from(message).toString();\n\n        try {\n          message = _circularJson[\"default\"].parse(message);\n        } catch (error) {\n          return;\n        } // check if any listeners are attached and forward event\n\n\n        if (message.notification && _this4.listeners(message.notification).length) {\n          if (!Object.keys(message.params).length) return _this4.emit(message.notification);\n          var args = [message.notification];\n          if (message.params.constructor === Object) args.push(message.params);else // using for-loop instead of unshift/spread because performance is better\n            for (var i = 0; i < message.params.length; i++) {\n              args.push(message.params[i]);\n            } // run as microtask so that pending queue messages are resolved first\n          // eslint-disable-next-line prefer-spread\n\n          return Promise.resolve().then(function () {\n            _this4.emit.apply(_this4, args);\n          });\n        }\n\n        if (!_this4.queue[message.id]) {\n          // general JSON RPC 2.0 events\n          if (message.method && message.params) {\n            // run as microtask so that pending queue messages are resolved first\n            return Promise.resolve().then(function () {\n              _this4.emit(message.method, message.params);\n            });\n          }\n\n          return;\n        } // reject early since server's response is invalid\n\n\n        if (\"error\" in message === \"result\" in message) _this4.queue[message.id].promise[1](new Error(\"Server response malformed. Response must include either \\\"result\\\"\" + \" or \\\"error\\\", but not both.\"));\n        if (_this4.queue[message.id].timeout) clearTimeout(_this4.queue[message.id].timeout);\n        if (message.error) _this4.queue[message.id].promise[1](message.error);else _this4.queue[message.id].promise[0](message.result);\n        delete _this4.queue[message.id];\n      });\n      this.socket.addEventListener(\"error\", function (error) {\n        return _this4.emit(\"error\", error);\n      });\n      this.socket.addEventListener(\"close\", function (_ref2) {\n        var code = _ref2.code,\n            reason = _ref2.reason;\n        if (_this4.ready) // Delay close event until internal state is updated\n          setTimeout(function () {\n            return _this4.emit(\"close\", code, reason);\n          }, 0);\n        _this4.ready = false;\n        _this4.socket = undefined;\n        if (code === 1000) return;\n        _this4.current_reconnects++;\n        if (_this4.reconnect && (_this4.max_reconnects > _this4.current_reconnects || _this4.max_reconnects === 0)) setTimeout(function () {\n          return _this4._connect(address, options);\n        }, _this4.reconnect_interval);\n      });\n    }\n  }]);\n  return CommonClient;\n}(_eventemitter.EventEmitter);\n\nexports[\"default\"] = CommonClient;","map":{"version":3,"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","_regenerator","_asyncToGenerator2","_typeof2","_classCallCheck2","_createClass2","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","_eventemitter","_circularJson","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","arguments","apply","sham","Proxy","Date","prototype","toString","call","e","__rest","s","t","p","hasOwnProperty","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","CommonClient","_EventEmitter","_super","webSocketFactory","_this","address","undefined","_a","generate_request_id","_a$autoconnect","autoconnect","_a$reconnect","reconnect","_a$reconnect_interval","reconnect_interval","_a$max_reconnects","max_reconnects","rest_options","queue","rpc_id","ready","current_reconnects","_connect","assign","key","connect","socket","method","params","timeout","ws_opts","_this2","Promise","resolve","reject","Error","message","jsonrpc","id","send","JSON","stringify","error","promise","setTimeout","_login","mark","_callee","resp","wrap","_callee$","_context","prev","next","sent","abrupt","stop","login","_x","_listMethods","_callee2","_callee2$","_context2","listMethods","notify","_this3","_subscribe","_callee3","event","_callee3$","_context3","subscribe","_x2","_unsubscribe","_callee4","_callee4$","_context4","unsubscribe","_x3","close","code","data","options","_this4","addEventListener","emit","_ref","ArrayBuffer","Buffer","from","parse","notification","listeners","keys","args","push","then","clearTimeout","_ref2","reason","EventEmitter"],"sources":["E:/intoweb3/NBlockment/blockment/node_modules/rpc-websockets/dist/lib/client.js"],"sourcesContent":["/**\n * \"Client\" wraps \"ws\" or a browser-implemented \"WebSocket\" library\n * according to the environment providing JSON RPC 2.0 support on top.\n * @module Client\n */\n\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _eventemitter = require(\"eventemitter3\");\n\nvar _circularJson = _interopRequireDefault(require(\"circular-json\"));\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2[\"default\"])(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2[\"default\"])(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2[\"default\"])(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar __rest = void 0 && (void 0).__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}; // @ts-ignore\n\n\nvar CommonClient = /*#__PURE__*/function (_EventEmitter) {\n  (0, _inherits2[\"default\"])(CommonClient, _EventEmitter);\n\n  var _super = _createSuper(CommonClient);\n\n  /**\n   * Instantiate a Client class.\n   * @constructor\n   * @param {webSocketFactory} webSocketFactory - factory method for WebSocket\n   * @param {String} address - url to a websocket server\n   * @param {Object} options - ws options object with reconnect parameters\n   * @param {Function} generate_request_id - custom generation request Id\n   * @return {CommonClient}\n   */\n  function CommonClient(webSocketFactory) {\n    var _this;\n\n    var address = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"ws://localhost:8080\";\n\n    var _a = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    var generate_request_id = arguments.length > 3 ? arguments[3] : undefined;\n    (0, _classCallCheck2[\"default\"])(this, CommonClient);\n\n    var _a$autoconnect = _a.autoconnect,\n        autoconnect = _a$autoconnect === void 0 ? true : _a$autoconnect,\n        _a$reconnect = _a.reconnect,\n        reconnect = _a$reconnect === void 0 ? true : _a$reconnect,\n        _a$reconnect_interval = _a.reconnect_interval,\n        reconnect_interval = _a$reconnect_interval === void 0 ? 1000 : _a$reconnect_interval,\n        _a$max_reconnects = _a.max_reconnects,\n        max_reconnects = _a$max_reconnects === void 0 ? 5 : _a$max_reconnects,\n        rest_options = __rest(_a, [\"autoconnect\", \"reconnect\", \"reconnect_interval\", \"max_reconnects\"]);\n\n    _this = _super.call(this);\n    _this.webSocketFactory = webSocketFactory;\n    _this.queue = {};\n    _this.rpc_id = 0;\n    _this.address = address;\n    _this.autoconnect = autoconnect;\n    _this.ready = false;\n    _this.reconnect = reconnect;\n    _this.reconnect_interval = reconnect_interval;\n    _this.max_reconnects = max_reconnects;\n    _this.rest_options = rest_options;\n    _this.current_reconnects = 0;\n\n    _this.generate_request_id = generate_request_id || function () {\n      return ++_this.rpc_id;\n    };\n\n    if (_this.autoconnect) _this._connect(_this.address, Object.assign({\n      autoconnect: _this.autoconnect,\n      reconnect: _this.reconnect,\n      reconnect_interval: _this.reconnect_interval,\n      max_reconnects: _this.max_reconnects\n    }, _this.rest_options));\n    return _this;\n  }\n  /**\n   * Connects to a defined server if not connected already.\n   * @method\n   * @return {Undefined}\n   */\n\n\n  (0, _createClass2[\"default\"])(CommonClient, [{\n    key: \"connect\",\n    value: function connect() {\n      if (this.socket) return;\n\n      this._connect(this.address, Object.assign({\n        autoconnect: this.autoconnect,\n        reconnect: this.reconnect,\n        reconnect_interval: this.reconnect_interval,\n        max_reconnects: this.max_reconnects\n      }, this.rest_options));\n    }\n    /**\n     * Calls a registered RPC method on server.\n     * @method\n     * @param {String} method - RPC method name\n     * @param {Object|Array} params - optional method parameters\n     * @param {Number} timeout - RPC reply timeout value\n     * @param {Object} ws_opts - options passed to ws\n     * @return {Promise}\n     */\n\n  }, {\n    key: \"call\",\n    value: function call(method, params, timeout, ws_opts) {\n      var _this2 = this;\n\n      if (!ws_opts && \"object\" === (0, _typeof2[\"default\"])(timeout)) {\n        ws_opts = timeout;\n        timeout = null;\n      }\n\n      return new Promise(function (resolve, reject) {\n        if (!_this2.ready) return reject(new Error(\"socket not ready\"));\n\n        var rpc_id = _this2.generate_request_id(method, params);\n\n        var message = {\n          jsonrpc: \"2.0\",\n          method: method,\n          params: params || null,\n          id: rpc_id\n        };\n\n        _this2.socket.send(JSON.stringify(message), ws_opts, function (error) {\n          if (error) return reject(error);\n          _this2.queue[rpc_id] = {\n            promise: [resolve, reject]\n          };\n\n          if (timeout) {\n            _this2.queue[rpc_id].timeout = setTimeout(function () {\n              delete _this2.queue[rpc_id];\n              reject(new Error(\"reply timeout\"));\n            }, timeout);\n          }\n        });\n      });\n    }\n    /**\n     * Logins with the other side of the connection.\n     * @method\n     * @param {Object} params - Login credentials object\n     * @return {Promise}\n     */\n\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(params) {\n        var resp;\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.call(\"rpc.login\", params);\n\n              case 2:\n                resp = _context.sent;\n\n                if (resp) {\n                  _context.next = 5;\n                  break;\n                }\n\n                throw new Error(\"authentication failed\");\n\n              case 5:\n                return _context.abrupt(\"return\", resp);\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function login(_x) {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }()\n    /**\n     * Fetches a list of client's methods registered on server.\n     * @method\n     * @return {Array}\n     */\n\n  }, {\n    key: \"listMethods\",\n    value: function () {\n      var _listMethods = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee2() {\n        return _regenerator[\"default\"].wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.call(\"__listMethods\");\n\n              case 2:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function listMethods() {\n        return _listMethods.apply(this, arguments);\n      }\n\n      return listMethods;\n    }()\n    /**\n     * Sends a JSON-RPC 2.0 notification to server.\n     * @method\n     * @param {String} method - RPC method name\n     * @param {Object} params - optional method parameters\n     * @return {Promise}\n     */\n\n  }, {\n    key: \"notify\",\n    value: function notify(method, params) {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        if (!_this3.ready) return reject(new Error(\"socket not ready\"));\n        var message = {\n          jsonrpc: \"2.0\",\n          method: method,\n          params: params || null\n        };\n\n        _this3.socket.send(JSON.stringify(message), function (error) {\n          if (error) return reject(error);\n          resolve();\n        });\n      });\n    }\n    /**\n     * Subscribes for a defined event.\n     * @method\n     * @param {String|Array} event - event name\n     * @return {Undefined}\n     * @throws {Error}\n     */\n\n  }, {\n    key: \"subscribe\",\n    value: function () {\n      var _subscribe = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee3(event) {\n        var result;\n        return _regenerator[\"default\"].wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (typeof event === \"string\") event = [event];\n                _context3.next = 3;\n                return this.call(\"rpc.on\", event);\n\n              case 3:\n                result = _context3.sent;\n\n                if (!(typeof event === \"string\" && result[event] !== \"ok\")) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                throw new Error(\"Failed subscribing to an event '\" + event + \"' with: \" + result[event]);\n\n              case 6:\n                return _context3.abrupt(\"return\", result);\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function subscribe(_x2) {\n        return _subscribe.apply(this, arguments);\n      }\n\n      return subscribe;\n    }()\n    /**\n     * Unsubscribes from a defined event.\n     * @method\n     * @param {String|Array} event - event name\n     * @return {Undefined}\n     * @throws {Error}\n     */\n\n  }, {\n    key: \"unsubscribe\",\n    value: function () {\n      var _unsubscribe = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee4(event) {\n        var result;\n        return _regenerator[\"default\"].wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (typeof event === \"string\") event = [event];\n                _context4.next = 3;\n                return this.call(\"rpc.off\", event);\n\n              case 3:\n                result = _context4.sent;\n\n                if (!(typeof event === \"string\" && result[event] !== \"ok\")) {\n                  _context4.next = 6;\n                  break;\n                }\n\n                throw new Error(\"Failed unsubscribing from an event with: \" + result);\n\n              case 6:\n                return _context4.abrupt(\"return\", result);\n\n              case 7:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function unsubscribe(_x3) {\n        return _unsubscribe.apply(this, arguments);\n      }\n\n      return unsubscribe;\n    }()\n    /**\n     * Closes a WebSocket connection gracefully.\n     * @method\n     * @param {Number} code - socket close code\n     * @param {String} data - optional data to be sent before closing\n     * @return {Undefined}\n     */\n\n  }, {\n    key: \"close\",\n    value: function close(code, data) {\n      this.socket.close(code || 1000, data);\n    }\n    /**\n     * Connection/Message handler.\n     * @method\n     * @private\n     * @param {String} address - WebSocket API address\n     * @param {Object} options - ws options object\n     * @return {Undefined}\n     */\n\n  }, {\n    key: \"_connect\",\n    value: function _connect(address, options) {\n      var _this4 = this;\n\n      this.socket = this.webSocketFactory(address, options);\n      this.socket.addEventListener(\"open\", function () {\n        _this4.ready = true;\n\n        _this4.emit(\"open\");\n\n        _this4.current_reconnects = 0;\n      });\n      this.socket.addEventListener(\"message\", function (_ref) {\n        var message = _ref.data;\n        if (message instanceof ArrayBuffer) message = Buffer.from(message).toString();\n\n        try {\n          message = _circularJson[\"default\"].parse(message);\n        } catch (error) {\n          return;\n        } // check if any listeners are attached and forward event\n\n\n        if (message.notification && _this4.listeners(message.notification).length) {\n          if (!Object.keys(message.params).length) return _this4.emit(message.notification);\n          var args = [message.notification];\n          if (message.params.constructor === Object) args.push(message.params);else // using for-loop instead of unshift/spread because performance is better\n            for (var i = 0; i < message.params.length; i++) {\n              args.push(message.params[i]);\n            } // run as microtask so that pending queue messages are resolved first\n          // eslint-disable-next-line prefer-spread\n\n          return Promise.resolve().then(function () {\n            _this4.emit.apply(_this4, args);\n          });\n        }\n\n        if (!_this4.queue[message.id]) {\n          // general JSON RPC 2.0 events\n          if (message.method && message.params) {\n            // run as microtask so that pending queue messages are resolved first\n            return Promise.resolve().then(function () {\n              _this4.emit(message.method, message.params);\n            });\n          }\n\n          return;\n        } // reject early since server's response is invalid\n\n\n        if (\"error\" in message === \"result\" in message) _this4.queue[message.id].promise[1](new Error(\"Server response malformed. Response must include either \\\"result\\\"\" + \" or \\\"error\\\", but not both.\"));\n        if (_this4.queue[message.id].timeout) clearTimeout(_this4.queue[message.id].timeout);\n        if (message.error) _this4.queue[message.id].promise[1](message.error);else _this4.queue[message.id].promise[0](message.result);\n        delete _this4.queue[message.id];\n      });\n      this.socket.addEventListener(\"error\", function (error) {\n        return _this4.emit(\"error\", error);\n      });\n      this.socket.addEventListener(\"close\", function (_ref2) {\n        var code = _ref2.code,\n            reason = _ref2.reason;\n        if (_this4.ready) // Delay close event until internal state is updated\n          setTimeout(function () {\n            return _this4.emit(\"close\", code, reason);\n          }, 0);\n        _this4.ready = false;\n        _this4.socket = undefined;\n        if (code === 1000) return;\n        _this4.current_reconnects++;\n        if (_this4.reconnect && (_this4.max_reconnects > _this4.current_reconnects || _this4.max_reconnects === 0)) setTimeout(function () {\n          return _this4._connect(address, options);\n        }, _this4.reconnect_interval);\n      });\n    }\n  }]);\n  return CommonClient;\n}(_eventemitter.EventEmitter);\n\nexports[\"default\"] = CommonClient;"],"mappings":"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"},"metadata":{},"sourceType":"script"}