{"ast":null,"code":"const stringify = require('json-stable-stringify');\n\nmodule.exports = {\n  cacheIdentifierForPayload: cacheIdentifierForPayload,\n  canCache: canCache,\n  blockTagForPayload: blockTagForPayload,\n  paramsWithoutBlockTag: paramsWithoutBlockTag,\n  blockTagParamIndex: blockTagParamIndex,\n  cacheTypeForPayload: cacheTypeForPayload\n};\n\nfunction cacheIdentifierForPayload(payload) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (!canCache(payload)) return null;\n  const {\n    includeBlockRef\n  } = opts;\n  const params = includeBlockRef ? payload.params : paramsWithoutBlockTag(payload);\n  return payload.method + ':' + stringify(params);\n}\n\nfunction canCache(payload) {\n  return cacheTypeForPayload(payload) !== 'never';\n}\n\nfunction blockTagForPayload(payload) {\n  var index = blockTagParamIndex(payload); // Block tag param not passed.\n\n  if (index >= payload.params.length) {\n    return null;\n  }\n\n  return payload.params[index];\n}\n\nfunction paramsWithoutBlockTag(payload) {\n  var index = blockTagParamIndex(payload); // Block tag param not passed.\n\n  if (index >= payload.params.length) {\n    return payload.params;\n  } // eth_getBlockByNumber has the block tag first, then the optional includeTx? param\n\n\n  if (payload.method === 'eth_getBlockByNumber') {\n    return payload.params.slice(1);\n  }\n\n  return payload.params.slice(0, index);\n}\n\nfunction blockTagParamIndex(payload) {\n  switch (payload.method) {\n    // blockTag is third param\n    case 'eth_getStorageAt':\n      return 2;\n    // blockTag is second param\n\n    case 'eth_getBalance':\n    case 'eth_getCode':\n    case 'eth_getTransactionCount':\n    case 'eth_call':\n    case 'eth_estimateGas':\n      return 1;\n    // blockTag is first param\n\n    case 'eth_getBlockByNumber':\n      return 0;\n    // there is no blockTag\n\n    default:\n      return undefined;\n  }\n}\n\nfunction cacheTypeForPayload(payload) {\n  switch (payload.method) {\n    // cache permanently\n    case 'web3_clientVersion':\n    case 'web3_sha3':\n    case 'eth_protocolVersion':\n    case 'eth_getBlockTransactionCountByHash':\n    case 'eth_getUncleCountByBlockHash':\n    case 'eth_getCode':\n    case 'eth_getBlockByHash':\n    case 'eth_getTransactionByHash':\n    case 'eth_getTransactionByBlockHashAndIndex':\n    case 'eth_getTransactionReceipt':\n    case 'eth_getUncleByBlockHashAndIndex':\n    case 'eth_getCompilers':\n    case 'eth_compileLLL':\n    case 'eth_compileSolidity':\n    case 'eth_compileSerpent':\n    case 'shh_version':\n      return 'perma';\n    // cache until fork\n\n    case 'eth_getBlockByNumber':\n    case 'eth_getBlockTransactionCountByNumber':\n    case 'eth_getUncleCountByBlockNumber':\n    case 'eth_getTransactionByBlockNumberAndIndex':\n    case 'eth_getUncleByBlockNumberAndIndex':\n      return 'fork';\n    // cache for block\n\n    case 'eth_gasPrice':\n    case 'eth_getBalance':\n    case 'eth_getStorageAt':\n    case 'eth_getTransactionCount':\n    case 'eth_call':\n    case 'eth_estimateGas':\n    case 'eth_getFilterLogs':\n    case 'eth_getLogs':\n    case 'eth_blockNumber':\n      return 'block';\n    // never cache\n\n    case 'net_version':\n    case 'net_peerCount':\n    case 'net_listening':\n    case 'eth_syncing':\n    case 'eth_sign':\n    case 'eth_coinbase':\n    case 'eth_mining':\n    case 'eth_hashrate':\n    case 'eth_accounts':\n    case 'eth_sendTransaction':\n    case 'eth_sendRawTransaction':\n    case 'eth_newFilter':\n    case 'eth_newBlockFilter':\n    case 'eth_newPendingTransactionFilter':\n    case 'eth_uninstallFilter':\n    case 'eth_getFilterChanges':\n    case 'eth_getWork':\n    case 'eth_submitWork':\n    case 'eth_submitHashrate':\n    case 'db_putString':\n    case 'db_getString':\n    case 'db_putHex':\n    case 'db_getHex':\n    case 'shh_post':\n    case 'shh_newIdentity':\n    case 'shh_hasIdentity':\n    case 'shh_newGroup':\n    case 'shh_addToGroup':\n    case 'shh_newFilter':\n    case 'shh_uninstallFilter':\n    case 'shh_getFilterChanges':\n    case 'shh_getMessages':\n      return 'never';\n  }\n}","map":{"version":3,"names":["stringify","require","module","exports","cacheIdentifierForPayload","canCache","blockTagForPayload","paramsWithoutBlockTag","blockTagParamIndex","cacheTypeForPayload","payload","opts","includeBlockRef","params","method","index","length","slice","undefined"],"sources":["E:/intoweb3/NBlockment/blockment/node_modules/web3-provider-engine/util/rpc-cache-utils.js"],"sourcesContent":["const stringify = require('json-stable-stringify')\n\nmodule.exports = {\n  cacheIdentifierForPayload: cacheIdentifierForPayload,\n  canCache: canCache,\n  blockTagForPayload: blockTagForPayload,\n  paramsWithoutBlockTag: paramsWithoutBlockTag,\n  blockTagParamIndex: blockTagParamIndex,\n  cacheTypeForPayload: cacheTypeForPayload,\n}\n\nfunction cacheIdentifierForPayload(payload, opts = {}){\n  if (!canCache(payload)) return null\n  const { includeBlockRef } = opts\n  const params = includeBlockRef ? payload.params : paramsWithoutBlockTag(payload)\n  return payload.method + ':' + stringify(params)\n}\n\nfunction canCache(payload){\n  return cacheTypeForPayload(payload) !== 'never'\n}\n\nfunction blockTagForPayload(payload){\n  var index = blockTagParamIndex(payload);\n\n  // Block tag param not passed.\n  if (index >= payload.params.length) {\n    return null;\n  }\n\n  return payload.params[index];\n}\n\nfunction paramsWithoutBlockTag(payload){\n  var index = blockTagParamIndex(payload);\n\n  // Block tag param not passed.\n  if (index >= payload.params.length) {\n    return payload.params;\n  }\n\n  // eth_getBlockByNumber has the block tag first, then the optional includeTx? param\n  if (payload.method === 'eth_getBlockByNumber') {\n    return payload.params.slice(1);\n  }\n\n  return payload.params.slice(0,index);\n}\n\nfunction blockTagParamIndex(payload){\n  switch(payload.method) {\n    // blockTag is third param\n    case 'eth_getStorageAt':\n      return 2\n    // blockTag is second param\n    case 'eth_getBalance':\n    case 'eth_getCode':\n    case 'eth_getTransactionCount':\n    case 'eth_call':\n    case 'eth_estimateGas':\n      return 1\n    // blockTag is first param\n    case 'eth_getBlockByNumber':\n      return 0\n    // there is no blockTag\n    default:\n      return undefined\n  }\n}\n\nfunction cacheTypeForPayload(payload) {\n  switch (payload.method) {\n    // cache permanently\n    case 'web3_clientVersion':\n    case 'web3_sha3':\n    case 'eth_protocolVersion':\n    case 'eth_getBlockTransactionCountByHash':\n    case 'eth_getUncleCountByBlockHash':\n    case 'eth_getCode':\n    case 'eth_getBlockByHash':\n    case 'eth_getTransactionByHash':\n    case 'eth_getTransactionByBlockHashAndIndex':\n    case 'eth_getTransactionReceipt':\n    case 'eth_getUncleByBlockHashAndIndex':\n    case 'eth_getCompilers':\n    case 'eth_compileLLL':\n    case 'eth_compileSolidity':\n    case 'eth_compileSerpent':\n    case 'shh_version':\n      return 'perma'\n\n    // cache until fork\n    case 'eth_getBlockByNumber':\n    case 'eth_getBlockTransactionCountByNumber':\n    case 'eth_getUncleCountByBlockNumber':\n    case 'eth_getTransactionByBlockNumberAndIndex':\n    case 'eth_getUncleByBlockNumberAndIndex':\n      return 'fork'\n\n    // cache for block\n    case 'eth_gasPrice':\n    case 'eth_getBalance':\n    case 'eth_getStorageAt':\n    case 'eth_getTransactionCount':\n    case 'eth_call':\n    case 'eth_estimateGas':\n    case 'eth_getFilterLogs':\n    case 'eth_getLogs':\n    case 'eth_blockNumber':\n      return 'block'\n\n    // never cache\n    case 'net_version':\n    case 'net_peerCount':\n    case 'net_listening':\n    case 'eth_syncing':\n    case 'eth_sign':\n    case 'eth_coinbase':\n    case 'eth_mining':\n    case 'eth_hashrate':\n    case 'eth_accounts':\n    case 'eth_sendTransaction':\n    case 'eth_sendRawTransaction':\n    case 'eth_newFilter':\n    case 'eth_newBlockFilter':\n    case 'eth_newPendingTransactionFilter':\n    case 'eth_uninstallFilter':\n    case 'eth_getFilterChanges':\n    case 'eth_getWork':\n    case 'eth_submitWork':\n    case 'eth_submitHashrate':\n    case 'db_putString':\n    case 'db_getString':\n    case 'db_putHex':\n    case 'db_getHex':\n    case 'shh_post':\n    case 'shh_newIdentity':\n    case 'shh_hasIdentity':\n    case 'shh_newGroup':\n    case 'shh_addToGroup':\n    case 'shh_newFilter':\n    case 'shh_uninstallFilter':\n    case 'shh_getFilterChanges':\n    case 'shh_getMessages':\n      return 'never'\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}