{"ast":null,"code":"\"use strict\";\n\nvar _Reflect$construct = require(\"@babel/runtime-corejs3/core-js-stable/reflect/construct\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.UnsetOp = exports.SetOp = exports.RemoveOp = exports.RelationOp = exports.Op = exports.IncrementOp = exports.AddUniqueOp = exports.AddOp = void 0;\nexports.opFromJSON = opFromJSON;\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/getPrototypeOf\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _isArray = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _forEach = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _splice = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/splice\"));\n\nvar _map = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/map\"));\n\nvar _arrayContainsObject = _interopRequireDefault(require(\"./arrayContainsObject\"));\n\nvar _decode = _interopRequireDefault(require(\"./decode\"));\n\nvar _encode = _interopRequireDefault(require(\"./encode\"));\n\nvar _ParseObject = _interopRequireDefault(require(\"./ParseObject\"));\n\nvar _ParseRelation = _interopRequireDefault(require(\"./ParseRelation\"));\n\nvar _unique = _interopRequireDefault(require(\"./unique\"));\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function () {\n    var Super = (0, _getPrototypeOf2.default)(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2.default)(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(_Reflect$construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction opFromJSON(json\n/*: { [key: string]: any }*/\n)\n/*: ?Op*/\n{\n  if (!json || !json.__op) {\n    return null;\n  }\n\n  switch (json.__op) {\n    case 'Delete':\n      return new UnsetOp();\n\n    case 'Increment':\n      return new IncrementOp(json.amount);\n\n    case 'Add':\n      return new AddOp((0, _decode.default)(json.objects));\n\n    case 'AddUnique':\n      return new AddUniqueOp((0, _decode.default)(json.objects));\n\n    case 'Remove':\n      return new RemoveOp((0, _decode.default)(json.objects));\n\n    case 'AddRelation':\n      {\n        var toAdd = (0, _decode.default)(json.objects);\n\n        if (!(0, _isArray.default)(toAdd)) {\n          return new RelationOp([], []);\n        }\n\n        return new RelationOp(toAdd, []);\n      }\n\n    case 'RemoveRelation':\n      {\n        var toRemove = (0, _decode.default)(json.objects);\n\n        if (!(0, _isArray.default)(toRemove)) {\n          return new RelationOp([], []);\n        }\n\n        return new RelationOp([], toRemove);\n      }\n\n    case 'Batch':\n      {\n        var _toAdd = [];\n        var _toRemove = [];\n\n        for (var i = 0; i < json.ops.length; i++) {\n          if (json.ops[i].__op === 'AddRelation') {\n            _toAdd = (0, _concat.default)(_toAdd).call(_toAdd, (0, _decode.default)(json.ops[i].objects));\n          } else if (json.ops[i].__op === 'RemoveRelation') {\n            _toRemove = (0, _concat.default)(_toRemove).call(_toRemove, (0, _decode.default)(json.ops[i].objects));\n          }\n        }\n\n        return new RelationOp(_toAdd, _toRemove);\n      }\n\n    default:\n      return null;\n  }\n}\n\nvar Op = /*#__PURE__*/function () {\n  function Op() {\n    (0, _classCallCheck2.default)(this, Op);\n  }\n\n  (0, _createClass2.default)(Op, [{\n    key: \"applyTo\",\n    value: // Empty parent class\n    function ()\n    /*: mixed*/\n    {}\n    /* eslint-disable-line no-unused-vars */\n\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: ?Op*/\n    {}\n    /* eslint-disable-line no-unused-vars */\n\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: mixed*/\n    {}\n  }]);\n  return Op;\n}();\n\nexports.Op = Op;\n\nvar SetOp = /*#__PURE__*/function (_Op) {\n  (0, _inherits2.default)(SetOp, _Op);\n\n  var _super = _createSuper(SetOp);\n\n  function SetOp(value\n  /*: mixed*/\n  ) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, SetOp);\n    _this = _super.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"_value\", void 0);\n    _this._value = value;\n    return _this;\n  }\n\n  (0, _createClass2.default)(SetOp, [{\n    key: \"applyTo\",\n    value: function ()\n    /*: mixed*/\n    {\n      return this._value;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: SetOp*/\n    {\n      return new SetOp(this._value);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function (offline\n    /*:: ?: boolean*/\n    ) {\n      return (0, _encode.default)(this._value, false, true, undefined, offline);\n    }\n  }]);\n  return SetOp;\n}(Op);\n\nexports.SetOp = SetOp;\n\nvar UnsetOp = /*#__PURE__*/function (_Op2) {\n  (0, _inherits2.default)(UnsetOp, _Op2);\n\n  var _super2 = _createSuper(UnsetOp);\n\n  function UnsetOp() {\n    (0, _classCallCheck2.default)(this, UnsetOp);\n    return _super2.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(UnsetOp, [{\n    key: \"applyTo\",\n    value: function () {\n      return undefined;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: UnsetOp*/\n    {\n      return new UnsetOp();\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string }*/\n    {\n      return {\n        __op: 'Delete'\n      };\n    }\n  }]);\n  return UnsetOp;\n}(Op);\n\nexports.UnsetOp = UnsetOp;\n\nvar IncrementOp = /*#__PURE__*/function (_Op3) {\n  (0, _inherits2.default)(IncrementOp, _Op3);\n\n  var _super3 = _createSuper(IncrementOp);\n\n  function IncrementOp(amount\n  /*: number*/\n  ) {\n    var _this2;\n\n    (0, _classCallCheck2.default)(this, IncrementOp);\n    _this2 = _super3.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this2), \"_amount\", void 0);\n\n    if (typeof amount !== 'number') {\n      throw new TypeError('Increment Op must be initialized with a numeric amount.');\n    }\n\n    _this2._amount = amount;\n    return _this2;\n  }\n\n  (0, _createClass2.default)(IncrementOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: ?mixed*/\n    )\n    /*: number*/\n    {\n      if (typeof value === 'undefined') {\n        return this._amount;\n      }\n\n      if (typeof value !== 'number') {\n        throw new TypeError('Cannot increment a non-numeric value.');\n      }\n\n      return this._amount + value;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._amount);\n      }\n\n      if (previous instanceof IncrementOp) {\n        return new IncrementOp(this.applyTo(previous._amount));\n      }\n\n      throw new Error('Cannot merge Increment Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string, amount: number }*/\n    {\n      return {\n        __op: 'Increment',\n        amount: this._amount\n      };\n    }\n  }]);\n  return IncrementOp;\n}(Op);\n\nexports.IncrementOp = IncrementOp;\n\nvar AddOp = /*#__PURE__*/function (_Op4) {\n  (0, _inherits2.default)(AddOp, _Op4);\n\n  var _super4 = _createSuper(AddOp);\n\n  function AddOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this3;\n\n    (0, _classCallCheck2.default)(this, AddOp);\n    _this3 = _super4.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this3), \"_value\", void 0);\n    _this3._value = (0, _isArray.default)(value) ? value : [value];\n    return _this3;\n  }\n\n  (0, _createClass2.default)(AddOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return this._value;\n      }\n\n      if ((0, _isArray.default)(value)) {\n        return (0, _concat.default)(value).call(value, this._value);\n      }\n\n      throw new Error('Cannot add elements to a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._value);\n      }\n\n      if (previous instanceof AddOp) {\n        return new AddOp(this.applyTo(previous._value));\n      }\n\n      throw new Error('Cannot merge Add Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string, objects: mixed }*/\n    {\n      return {\n        __op: 'Add',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return AddOp;\n}(Op);\n\nexports.AddOp = AddOp;\n\nvar AddUniqueOp = /*#__PURE__*/function (_Op5) {\n  (0, _inherits2.default)(AddUniqueOp, _Op5);\n\n  var _super5 = _createSuper(AddUniqueOp);\n\n  function AddUniqueOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this4;\n\n    (0, _classCallCheck2.default)(this, AddUniqueOp);\n    _this4 = _super5.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this4), \"_value\", void 0);\n    _this4._value = (0, _unique.default)((0, _isArray.default)(value) ? value : [value]);\n    return _this4;\n  }\n\n  (0, _createClass2.default)(AddUniqueOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed | Array<mixed>*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return this._value || [];\n      }\n\n      if ((0, _isArray.default)(value)) {\n        var _context;\n\n        var toAdd = [];\n        (0, _forEach.default)(_context = this._value).call(_context, function (v) {\n          if (v instanceof _ParseObject.default) {\n            if (!(0, _arrayContainsObject.default)(value, v)) {\n              toAdd.push(v);\n            }\n          } else {\n            if ((0, _indexOf.default)(value).call(value, v) < 0) {\n              toAdd.push(v);\n            }\n          }\n        });\n        return (0, _concat.default)(value).call(value, toAdd);\n      }\n\n      throw new Error('Cannot add elements to a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._value);\n      }\n\n      if (previous instanceof AddUniqueOp) {\n        return new AddUniqueOp(this.applyTo(previous._value));\n      }\n\n      throw new Error('Cannot merge AddUnique Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string, objects: mixed }*/\n    {\n      return {\n        __op: 'AddUnique',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return AddUniqueOp;\n}(Op);\n\nexports.AddUniqueOp = AddUniqueOp;\n\nvar RemoveOp = /*#__PURE__*/function (_Op6) {\n  (0, _inherits2.default)(RemoveOp, _Op6);\n\n  var _super6 = _createSuper(RemoveOp);\n\n  function RemoveOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this5;\n\n    (0, _classCallCheck2.default)(this, RemoveOp);\n    _this5 = _super6.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this5), \"_value\", void 0);\n    _this5._value = (0, _unique.default)((0, _isArray.default)(value) ? value : [value]);\n    return _this5;\n  }\n\n  (0, _createClass2.default)(RemoveOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed | Array<mixed>*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return [];\n      }\n\n      if ((0, _isArray.default)(value)) {\n        // var i = value.indexOf(this._value);\n        var removed = (0, _concat.default)(value).call(value, []);\n\n        for (var i = 0; i < this._value.length; i++) {\n          var index = (0, _indexOf.default)(removed).call(removed, this._value[i]);\n\n          while (index > -1) {\n            (0, _splice.default)(removed).call(removed, index, 1);\n            index = (0, _indexOf.default)(removed).call(removed, this._value[i]);\n          }\n\n          if (this._value[i] instanceof _ParseObject.default && this._value[i].id) {\n            for (var j = 0; j < removed.length; j++) {\n              if (removed[j] instanceof _ParseObject.default && this._value[i].id === removed[j].id) {\n                (0, _splice.default)(removed).call(removed, j, 1);\n                j--;\n              }\n            }\n          }\n        }\n\n        return removed;\n      }\n\n      throw new Error('Cannot remove elements from a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new UnsetOp();\n      }\n\n      if (previous instanceof RemoveOp) {\n        var _context2;\n\n        var uniques = (0, _concat.default)(_context2 = previous._value).call(_context2, []);\n\n        for (var i = 0; i < this._value.length; i++) {\n          if (this._value[i] instanceof _ParseObject.default) {\n            if (!(0, _arrayContainsObject.default)(uniques, this._value[i])) {\n              uniques.push(this._value[i]);\n            }\n          } else {\n            if ((0, _indexOf.default)(uniques).call(uniques, this._value[i]) < 0) {\n              uniques.push(this._value[i]);\n            }\n          }\n        }\n\n        return new RemoveOp(uniques);\n      }\n\n      throw new Error('Cannot merge Remove Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string, objects: mixed }*/\n    {\n      return {\n        __op: 'Remove',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return RemoveOp;\n}(Op);\n\nexports.RemoveOp = RemoveOp;\n\nvar RelationOp = /*#__PURE__*/function (_Op7) {\n  (0, _inherits2.default)(RelationOp, _Op7);\n\n  var _super7 = _createSuper(RelationOp);\n\n  function RelationOp(adds\n  /*: Array<ParseObject | string>*/\n  , removes\n  /*: Array<ParseObject | string>*/\n  ) {\n    var _this6;\n\n    (0, _classCallCheck2.default)(this, RelationOp);\n    _this6 = _super7.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"_targetClassName\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"relationsToAdd\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"relationsToRemove\", void 0);\n    _this6._targetClassName = null;\n\n    if ((0, _isArray.default)(adds)) {\n      _this6.relationsToAdd = (0, _unique.default)((0, _map.default)(adds).call(adds, _this6._extractId, (0, _assertThisInitialized2.default)(_this6)));\n    }\n\n    if ((0, _isArray.default)(removes)) {\n      _this6.relationsToRemove = (0, _unique.default)((0, _map.default)(removes).call(removes, _this6._extractId, (0, _assertThisInitialized2.default)(_this6)));\n    }\n\n    return _this6;\n  }\n\n  (0, _createClass2.default)(RelationOp, [{\n    key: \"_extractId\",\n    value: function (obj\n    /*: string | ParseObject*/\n    )\n    /*: string*/\n    {\n      if (typeof obj === 'string') {\n        return obj;\n      }\n\n      if (!obj.id) {\n        throw new Error('You cannot add or remove an unsaved Parse Object from a relation');\n      }\n\n      if (!this._targetClassName) {\n        this._targetClassName = obj.className;\n      }\n\n      if (this._targetClassName !== obj.className) {\n        var _context3;\n\n        throw new Error((0, _concat.default)(_context3 = \"Tried to create a Relation with 2 different object types: \".concat(this._targetClassName, \" and \")).call(_context3, obj.className, \".\"));\n      }\n\n      return obj.id;\n    }\n  }, {\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed*/\n    , object\n    /*:: ?: { className: string, id: ?string }*/\n    , key\n    /*:: ?: string*/\n    )\n    /*: ?ParseRelation*/\n    {\n      if (!value) {\n        var _context4;\n\n        if (!object || !key) {\n          throw new Error('Cannot apply a RelationOp without either a previous value, or an object and a key');\n        }\n\n        var parent = new _ParseObject.default(object.className);\n\n        if (object.id && (0, _indexOf.default)(_context4 = object.id).call(_context4, 'local') === 0) {\n          parent._localId = object.id;\n        } else if (object.id) {\n          parent.id = object.id;\n        }\n\n        var relation = new _ParseRelation.default(parent, key);\n        relation.targetClassName = this._targetClassName;\n        return relation;\n      }\n\n      if (value instanceof _ParseRelation.default) {\n        if (this._targetClassName) {\n          if (value.targetClassName) {\n            if (this._targetClassName !== value.targetClassName) {\n              var _context5;\n\n              throw new Error((0, _concat.default)(_context5 = \"Related object must be a \".concat(value.targetClassName, \", but a \")).call(_context5, this._targetClassName, \" was passed in.\"));\n            }\n          } else {\n            value.targetClassName = this._targetClassName;\n          }\n        }\n\n        return value;\n      }\n\n      throw new Error('Relation cannot be applied to a non-relation field');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof UnsetOp) {\n        throw new Error('You cannot modify a relation after deleting it.');\n      }\n\n      if (previous instanceof SetOp && previous._value instanceof _ParseRelation.default) {\n        return this;\n      }\n\n      if (previous instanceof RelationOp) {\n        var _context7, _context8, _context9, _context10, _context11, _context12;\n\n        if (previous._targetClassName && previous._targetClassName !== this._targetClassName) {\n          var _context6;\n\n          throw new Error((0, _concat.default)(_context6 = \"Related object must be of class \".concat(previous._targetClassName, \", but \")).call(_context6, this._targetClassName || 'null', \" was passed in.\"));\n        }\n\n        var newAdd = (0, _concat.default)(_context7 = previous.relationsToAdd).call(_context7, []);\n        (0, _forEach.default)(_context8 = this.relationsToRemove).call(_context8, function (r) {\n          var index = (0, _indexOf.default)(newAdd).call(newAdd, r);\n\n          if (index > -1) {\n            (0, _splice.default)(newAdd).call(newAdd, index, 1);\n          }\n        });\n        (0, _forEach.default)(_context9 = this.relationsToAdd).call(_context9, function (r) {\n          var index = (0, _indexOf.default)(newAdd).call(newAdd, r);\n\n          if (index < 0) {\n            newAdd.push(r);\n          }\n        });\n        var newRemove = (0, _concat.default)(_context10 = previous.relationsToRemove).call(_context10, []);\n        (0, _forEach.default)(_context11 = this.relationsToAdd).call(_context11, function (r) {\n          var index = (0, _indexOf.default)(newRemove).call(newRemove, r);\n\n          if (index > -1) {\n            (0, _splice.default)(newRemove).call(newRemove, index, 1);\n          }\n        });\n        (0, _forEach.default)(_context12 = this.relationsToRemove).call(_context12, function (r) {\n          var index = (0, _indexOf.default)(newRemove).call(newRemove, r);\n\n          if (index < 0) {\n            newRemove.push(r);\n          }\n        });\n        var newRelation = new RelationOp(newAdd, newRemove);\n        newRelation._targetClassName = this._targetClassName;\n        return newRelation;\n      }\n\n      throw new Error('Cannot merge Relation Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op?: string, objects?: mixed, ops?: mixed }*/\n    {\n      var _this7 = this;\n\n      var idToPointer = function (id) {\n        return {\n          __type: 'Pointer',\n          className: _this7._targetClassName,\n          objectId: id\n        };\n      };\n\n      var adds = null;\n      var removes = null;\n      var pointers = null;\n\n      if (this.relationsToAdd.length > 0) {\n        var _context13;\n\n        pointers = (0, _map.default)(_context13 = this.relationsToAdd).call(_context13, idToPointer);\n        adds = {\n          __op: 'AddRelation',\n          objects: pointers\n        };\n      }\n\n      if (this.relationsToRemove.length > 0) {\n        var _context14;\n\n        pointers = (0, _map.default)(_context14 = this.relationsToRemove).call(_context14, idToPointer);\n        removes = {\n          __op: 'RemoveRelation',\n          objects: pointers\n        };\n      }\n\n      if (adds && removes) {\n        return {\n          __op: 'Batch',\n          ops: [adds, removes]\n        };\n      }\n\n      return adds || removes || {};\n    }\n  }]);\n  return RelationOp;\n}(Op);\n\nexports.RelationOp = RelationOp;","map":{"version":3,"names":["_Reflect$construct","require","_Object$defineProperty","_interopRequireDefault","exports","value","UnsetOp","SetOp","RemoveOp","RelationOp","Op","IncrementOp","AddUniqueOp","AddOp","opFromJSON","_assertThisInitialized2","_inherits2","_possibleConstructorReturn2","_getPrototypeOf2","_defineProperty2","_classCallCheck2","_createClass2","_isArray","_concat","_forEach","_indexOf","_splice","_map","_arrayContainsObject","_decode","_encode","_ParseObject","_ParseRelation","_unique","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","Super","default","result","NewTarget","constructor","arguments","apply","Reflect","sham","Proxy","Boolean","prototype","valueOf","call","e","json","__op","amount","objects","toAdd","toRemove","_toAdd","_toRemove","i","ops","length","key","_Op","_super","_this","_value","offline","undefined","_Op2","_super2","_Op3","_super3","_this2","TypeError","_amount","previous","applyTo","Error","_Op4","_super4","_this3","_Op5","_super5","_this4","_context","v","push","_Op6","_super6","_this5","removed","index","id","j","_context2","uniques","_Op7","_super7","adds","removes","_this6","_targetClassName","relationsToAdd","_extractId","relationsToRemove","obj","className","_context3","concat","object","_context4","parent","_localId","relation","targetClassName","_context5","_context7","_context8","_context9","_context10","_context11","_context12","_context6","newAdd","r","newRemove","newRelation","_this7","idToPointer","__type","objectId","pointers","_context13","_context14"],"sources":["E:/intoweb3/NBlockment/blockment/node_modules/moralis/lib/browser/ParseOp.js"],"sourcesContent":["\"use strict\";\n\nvar _Reflect$construct = require(\"@babel/runtime-corejs3/core-js-stable/reflect/construct\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.UnsetOp = exports.SetOp = exports.RemoveOp = exports.RelationOp = exports.Op = exports.IncrementOp = exports.AddUniqueOp = exports.AddOp = void 0;\nexports.opFromJSON = opFromJSON;\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/getPrototypeOf\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _isArray = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _forEach = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _splice = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/splice\"));\n\nvar _map = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/map\"));\n\nvar _arrayContainsObject = _interopRequireDefault(require(\"./arrayContainsObject\"));\n\nvar _decode = _interopRequireDefault(require(\"./decode\"));\n\nvar _encode = _interopRequireDefault(require(\"./encode\"));\n\nvar _ParseObject = _interopRequireDefault(require(\"./ParseObject\"));\n\nvar _ParseRelation = _interopRequireDefault(require(\"./ParseRelation\"));\n\nvar _unique = _interopRequireDefault(require(\"./unique\"));\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function () {\n    var Super = (0, _getPrototypeOf2.default)(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2.default)(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(_Reflect$construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction opFromJSON(json\n/*: { [key: string]: any }*/\n)\n/*: ?Op*/\n{\n  if (!json || !json.__op) {\n    return null;\n  }\n\n  switch (json.__op) {\n    case 'Delete':\n      return new UnsetOp();\n\n    case 'Increment':\n      return new IncrementOp(json.amount);\n\n    case 'Add':\n      return new AddOp((0, _decode.default)(json.objects));\n\n    case 'AddUnique':\n      return new AddUniqueOp((0, _decode.default)(json.objects));\n\n    case 'Remove':\n      return new RemoveOp((0, _decode.default)(json.objects));\n\n    case 'AddRelation':\n      {\n        var toAdd = (0, _decode.default)(json.objects);\n\n        if (!(0, _isArray.default)(toAdd)) {\n          return new RelationOp([], []);\n        }\n\n        return new RelationOp(toAdd, []);\n      }\n\n    case 'RemoveRelation':\n      {\n        var toRemove = (0, _decode.default)(json.objects);\n\n        if (!(0, _isArray.default)(toRemove)) {\n          return new RelationOp([], []);\n        }\n\n        return new RelationOp([], toRemove);\n      }\n\n    case 'Batch':\n      {\n        var _toAdd = [];\n        var _toRemove = [];\n\n        for (var i = 0; i < json.ops.length; i++) {\n          if (json.ops[i].__op === 'AddRelation') {\n            _toAdd = (0, _concat.default)(_toAdd).call(_toAdd, (0, _decode.default)(json.ops[i].objects));\n          } else if (json.ops[i].__op === 'RemoveRelation') {\n            _toRemove = (0, _concat.default)(_toRemove).call(_toRemove, (0, _decode.default)(json.ops[i].objects));\n          }\n        }\n\n        return new RelationOp(_toAdd, _toRemove);\n      }\n\n    default:\n      return null;\n  }\n}\n\nvar Op = /*#__PURE__*/function () {\n  function Op() {\n    (0, _classCallCheck2.default)(this, Op);\n  }\n\n  (0, _createClass2.default)(Op, [{\n    key: \"applyTo\",\n    value: // Empty parent class\n    function ()\n    /*: mixed*/\n    {}\n    /* eslint-disable-line no-unused-vars */\n\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: ?Op*/\n    {}\n    /* eslint-disable-line no-unused-vars */\n\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: mixed*/\n    {}\n  }]);\n  return Op;\n}();\n\nexports.Op = Op;\n\nvar SetOp = /*#__PURE__*/function (_Op) {\n  (0, _inherits2.default)(SetOp, _Op);\n\n  var _super = _createSuper(SetOp);\n\n  function SetOp(value\n  /*: mixed*/\n  ) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, SetOp);\n    _this = _super.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"_value\", void 0);\n    _this._value = value;\n    return _this;\n  }\n\n  (0, _createClass2.default)(SetOp, [{\n    key: \"applyTo\",\n    value: function ()\n    /*: mixed*/\n    {\n      return this._value;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: SetOp*/\n    {\n      return new SetOp(this._value);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function (offline\n    /*:: ?: boolean*/\n    ) {\n      return (0, _encode.default)(this._value, false, true, undefined, offline);\n    }\n  }]);\n  return SetOp;\n}(Op);\n\nexports.SetOp = SetOp;\n\nvar UnsetOp = /*#__PURE__*/function (_Op2) {\n  (0, _inherits2.default)(UnsetOp, _Op2);\n\n  var _super2 = _createSuper(UnsetOp);\n\n  function UnsetOp() {\n    (0, _classCallCheck2.default)(this, UnsetOp);\n    return _super2.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(UnsetOp, [{\n    key: \"applyTo\",\n    value: function () {\n      return undefined;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: UnsetOp*/\n    {\n      return new UnsetOp();\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string }*/\n    {\n      return {\n        __op: 'Delete'\n      };\n    }\n  }]);\n  return UnsetOp;\n}(Op);\n\nexports.UnsetOp = UnsetOp;\n\nvar IncrementOp = /*#__PURE__*/function (_Op3) {\n  (0, _inherits2.default)(IncrementOp, _Op3);\n\n  var _super3 = _createSuper(IncrementOp);\n\n  function IncrementOp(amount\n  /*: number*/\n  ) {\n    var _this2;\n\n    (0, _classCallCheck2.default)(this, IncrementOp);\n    _this2 = _super3.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this2), \"_amount\", void 0);\n\n    if (typeof amount !== 'number') {\n      throw new TypeError('Increment Op must be initialized with a numeric amount.');\n    }\n\n    _this2._amount = amount;\n    return _this2;\n  }\n\n  (0, _createClass2.default)(IncrementOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: ?mixed*/\n    )\n    /*: number*/\n    {\n      if (typeof value === 'undefined') {\n        return this._amount;\n      }\n\n      if (typeof value !== 'number') {\n        throw new TypeError('Cannot increment a non-numeric value.');\n      }\n\n      return this._amount + value;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._amount);\n      }\n\n      if (previous instanceof IncrementOp) {\n        return new IncrementOp(this.applyTo(previous._amount));\n      }\n\n      throw new Error('Cannot merge Increment Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string, amount: number }*/\n    {\n      return {\n        __op: 'Increment',\n        amount: this._amount\n      };\n    }\n  }]);\n  return IncrementOp;\n}(Op);\n\nexports.IncrementOp = IncrementOp;\n\nvar AddOp = /*#__PURE__*/function (_Op4) {\n  (0, _inherits2.default)(AddOp, _Op4);\n\n  var _super4 = _createSuper(AddOp);\n\n  function AddOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this3;\n\n    (0, _classCallCheck2.default)(this, AddOp);\n    _this3 = _super4.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this3), \"_value\", void 0);\n    _this3._value = (0, _isArray.default)(value) ? value : [value];\n    return _this3;\n  }\n\n  (0, _createClass2.default)(AddOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return this._value;\n      }\n\n      if ((0, _isArray.default)(value)) {\n        return (0, _concat.default)(value).call(value, this._value);\n      }\n\n      throw new Error('Cannot add elements to a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._value);\n      }\n\n      if (previous instanceof AddOp) {\n        return new AddOp(this.applyTo(previous._value));\n      }\n\n      throw new Error('Cannot merge Add Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string, objects: mixed }*/\n    {\n      return {\n        __op: 'Add',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return AddOp;\n}(Op);\n\nexports.AddOp = AddOp;\n\nvar AddUniqueOp = /*#__PURE__*/function (_Op5) {\n  (0, _inherits2.default)(AddUniqueOp, _Op5);\n\n  var _super5 = _createSuper(AddUniqueOp);\n\n  function AddUniqueOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this4;\n\n    (0, _classCallCheck2.default)(this, AddUniqueOp);\n    _this4 = _super5.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this4), \"_value\", void 0);\n    _this4._value = (0, _unique.default)((0, _isArray.default)(value) ? value : [value]);\n    return _this4;\n  }\n\n  (0, _createClass2.default)(AddUniqueOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed | Array<mixed>*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return this._value || [];\n      }\n\n      if ((0, _isArray.default)(value)) {\n        var _context;\n\n        var toAdd = [];\n        (0, _forEach.default)(_context = this._value).call(_context, function (v) {\n          if (v instanceof _ParseObject.default) {\n            if (!(0, _arrayContainsObject.default)(value, v)) {\n              toAdd.push(v);\n            }\n          } else {\n            if ((0, _indexOf.default)(value).call(value, v) < 0) {\n              toAdd.push(v);\n            }\n          }\n        });\n        return (0, _concat.default)(value).call(value, toAdd);\n      }\n\n      throw new Error('Cannot add elements to a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._value);\n      }\n\n      if (previous instanceof AddUniqueOp) {\n        return new AddUniqueOp(this.applyTo(previous._value));\n      }\n\n      throw new Error('Cannot merge AddUnique Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string, objects: mixed }*/\n    {\n      return {\n        __op: 'AddUnique',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return AddUniqueOp;\n}(Op);\n\nexports.AddUniqueOp = AddUniqueOp;\n\nvar RemoveOp = /*#__PURE__*/function (_Op6) {\n  (0, _inherits2.default)(RemoveOp, _Op6);\n\n  var _super6 = _createSuper(RemoveOp);\n\n  function RemoveOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this5;\n\n    (0, _classCallCheck2.default)(this, RemoveOp);\n    _this5 = _super6.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this5), \"_value\", void 0);\n    _this5._value = (0, _unique.default)((0, _isArray.default)(value) ? value : [value]);\n    return _this5;\n  }\n\n  (0, _createClass2.default)(RemoveOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed | Array<mixed>*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return [];\n      }\n\n      if ((0, _isArray.default)(value)) {\n        // var i = value.indexOf(this._value);\n        var removed = (0, _concat.default)(value).call(value, []);\n\n        for (var i = 0; i < this._value.length; i++) {\n          var index = (0, _indexOf.default)(removed).call(removed, this._value[i]);\n\n          while (index > -1) {\n            (0, _splice.default)(removed).call(removed, index, 1);\n            index = (0, _indexOf.default)(removed).call(removed, this._value[i]);\n          }\n\n          if (this._value[i] instanceof _ParseObject.default && this._value[i].id) {\n            for (var j = 0; j < removed.length; j++) {\n              if (removed[j] instanceof _ParseObject.default && this._value[i].id === removed[j].id) {\n                (0, _splice.default)(removed).call(removed, j, 1);\n                j--;\n              }\n            }\n          }\n        }\n\n        return removed;\n      }\n\n      throw new Error('Cannot remove elements from a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new UnsetOp();\n      }\n\n      if (previous instanceof RemoveOp) {\n        var _context2;\n\n        var uniques = (0, _concat.default)(_context2 = previous._value).call(_context2, []);\n\n        for (var i = 0; i < this._value.length; i++) {\n          if (this._value[i] instanceof _ParseObject.default) {\n            if (!(0, _arrayContainsObject.default)(uniques, this._value[i])) {\n              uniques.push(this._value[i]);\n            }\n          } else {\n            if ((0, _indexOf.default)(uniques).call(uniques, this._value[i]) < 0) {\n              uniques.push(this._value[i]);\n            }\n          }\n        }\n\n        return new RemoveOp(uniques);\n      }\n\n      throw new Error('Cannot merge Remove Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string, objects: mixed }*/\n    {\n      return {\n        __op: 'Remove',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return RemoveOp;\n}(Op);\n\nexports.RemoveOp = RemoveOp;\n\nvar RelationOp = /*#__PURE__*/function (_Op7) {\n  (0, _inherits2.default)(RelationOp, _Op7);\n\n  var _super7 = _createSuper(RelationOp);\n\n  function RelationOp(adds\n  /*: Array<ParseObject | string>*/\n  , removes\n  /*: Array<ParseObject | string>*/\n  ) {\n    var _this6;\n\n    (0, _classCallCheck2.default)(this, RelationOp);\n    _this6 = _super7.call(this);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"_targetClassName\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"relationsToAdd\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"relationsToRemove\", void 0);\n    _this6._targetClassName = null;\n\n    if ((0, _isArray.default)(adds)) {\n      _this6.relationsToAdd = (0, _unique.default)((0, _map.default)(adds).call(adds, _this6._extractId, (0, _assertThisInitialized2.default)(_this6)));\n    }\n\n    if ((0, _isArray.default)(removes)) {\n      _this6.relationsToRemove = (0, _unique.default)((0, _map.default)(removes).call(removes, _this6._extractId, (0, _assertThisInitialized2.default)(_this6)));\n    }\n\n    return _this6;\n  }\n\n  (0, _createClass2.default)(RelationOp, [{\n    key: \"_extractId\",\n    value: function (obj\n    /*: string | ParseObject*/\n    )\n    /*: string*/\n    {\n      if (typeof obj === 'string') {\n        return obj;\n      }\n\n      if (!obj.id) {\n        throw new Error('You cannot add or remove an unsaved Parse Object from a relation');\n      }\n\n      if (!this._targetClassName) {\n        this._targetClassName = obj.className;\n      }\n\n      if (this._targetClassName !== obj.className) {\n        var _context3;\n\n        throw new Error((0, _concat.default)(_context3 = \"Tried to create a Relation with 2 different object types: \".concat(this._targetClassName, \" and \")).call(_context3, obj.className, \".\"));\n      }\n\n      return obj.id;\n    }\n  }, {\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed*/\n    , object\n    /*:: ?: { className: string, id: ?string }*/\n    , key\n    /*:: ?: string*/\n    )\n    /*: ?ParseRelation*/\n    {\n      if (!value) {\n        var _context4;\n\n        if (!object || !key) {\n          throw new Error('Cannot apply a RelationOp without either a previous value, or an object and a key');\n        }\n\n        var parent = new _ParseObject.default(object.className);\n\n        if (object.id && (0, _indexOf.default)(_context4 = object.id).call(_context4, 'local') === 0) {\n          parent._localId = object.id;\n        } else if (object.id) {\n          parent.id = object.id;\n        }\n\n        var relation = new _ParseRelation.default(parent, key);\n        relation.targetClassName = this._targetClassName;\n        return relation;\n      }\n\n      if (value instanceof _ParseRelation.default) {\n        if (this._targetClassName) {\n          if (value.targetClassName) {\n            if (this._targetClassName !== value.targetClassName) {\n              var _context5;\n\n              throw new Error((0, _concat.default)(_context5 = \"Related object must be a \".concat(value.targetClassName, \", but a \")).call(_context5, this._targetClassName, \" was passed in.\"));\n            }\n          } else {\n            value.targetClassName = this._targetClassName;\n          }\n        }\n\n        return value;\n      }\n\n      throw new Error('Relation cannot be applied to a non-relation field');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof UnsetOp) {\n        throw new Error('You cannot modify a relation after deleting it.');\n      }\n\n      if (previous instanceof SetOp && previous._value instanceof _ParseRelation.default) {\n        return this;\n      }\n\n      if (previous instanceof RelationOp) {\n        var _context7, _context8, _context9, _context10, _context11, _context12;\n\n        if (previous._targetClassName && previous._targetClassName !== this._targetClassName) {\n          var _context6;\n\n          throw new Error((0, _concat.default)(_context6 = \"Related object must be of class \".concat(previous._targetClassName, \", but \")).call(_context6, this._targetClassName || 'null', \" was passed in.\"));\n        }\n\n        var newAdd = (0, _concat.default)(_context7 = previous.relationsToAdd).call(_context7, []);\n        (0, _forEach.default)(_context8 = this.relationsToRemove).call(_context8, function (r) {\n          var index = (0, _indexOf.default)(newAdd).call(newAdd, r);\n\n          if (index > -1) {\n            (0, _splice.default)(newAdd).call(newAdd, index, 1);\n          }\n        });\n        (0, _forEach.default)(_context9 = this.relationsToAdd).call(_context9, function (r) {\n          var index = (0, _indexOf.default)(newAdd).call(newAdd, r);\n\n          if (index < 0) {\n            newAdd.push(r);\n          }\n        });\n        var newRemove = (0, _concat.default)(_context10 = previous.relationsToRemove).call(_context10, []);\n        (0, _forEach.default)(_context11 = this.relationsToAdd).call(_context11, function (r) {\n          var index = (0, _indexOf.default)(newRemove).call(newRemove, r);\n\n          if (index > -1) {\n            (0, _splice.default)(newRemove).call(newRemove, index, 1);\n          }\n        });\n        (0, _forEach.default)(_context12 = this.relationsToRemove).call(_context12, function (r) {\n          var index = (0, _indexOf.default)(newRemove).call(newRemove, r);\n\n          if (index < 0) {\n            newRemove.push(r);\n          }\n        });\n        var newRelation = new RelationOp(newAdd, newRemove);\n        newRelation._targetClassName = this._targetClassName;\n        return newRelation;\n      }\n\n      throw new Error('Cannot merge Relation Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op?: string, objects?: mixed, ops?: mixed }*/\n    {\n      var _this7 = this;\n\n      var idToPointer = function (id) {\n        return {\n          __type: 'Pointer',\n          className: _this7._targetClassName,\n          objectId: id\n        };\n      };\n\n      var adds = null;\n      var removes = null;\n      var pointers = null;\n\n      if (this.relationsToAdd.length > 0) {\n        var _context13;\n\n        pointers = (0, _map.default)(_context13 = this.relationsToAdd).call(_context13, idToPointer);\n        adds = {\n          __op: 'AddRelation',\n          objects: pointers\n        };\n      }\n\n      if (this.relationsToRemove.length > 0) {\n        var _context14;\n\n        pointers = (0, _map.default)(_context14 = this.relationsToRemove).call(_context14, idToPointer);\n        removes = {\n          __op: 'RemoveRelation',\n          objects: pointers\n        };\n      }\n\n      if (adds && removes) {\n        return {\n          __op: 'Batch',\n          ops: [adds, removes]\n        };\n      }\n\n      return adds || removes || {};\n    }\n  }]);\n  return RelationOp;\n}(Op);\n\nexports.RelationOp = RelationOp;"],"mappings":"AAAA;;AAEA,IAAIA,kBAAkB,GAAGC,OAAO,CAAC,yDAAD,CAAhC;;AAEA,IAAIC,sBAAsB,GAAGD,OAAO,CAAC,8DAAD,CAApC;;AAEA,IAAIE,sBAAsB,GAAGF,OAAO,CAAC,sDAAD,CAApC;;AAEAC,sBAAsB,CAACE,OAAD,EAAU,YAAV,EAAwB;EAC5CC,KAAK,EAAE;AADqC,CAAxB,CAAtB;;AAIAD,OAAO,CAACE,OAAR,GAAkBF,OAAO,CAACG,KAAR,GAAgBH,OAAO,CAACI,QAAR,GAAmBJ,OAAO,CAACK,UAAR,GAAqBL,OAAO,CAACM,EAAR,GAAaN,OAAO,CAACO,WAAR,GAAsBP,OAAO,CAACQ,WAAR,GAAsBR,OAAO,CAACS,KAAR,GAAgB,KAAK,CAAxJ;AACAT,OAAO,CAACU,UAAR,GAAqBA,UAArB;;AAEA,IAAIC,uBAAuB,GAAGZ,sBAAsB,CAACF,OAAO,CAAC,sDAAD,CAAR,CAApD;;AAEA,IAAIe,UAAU,GAAGb,sBAAsB,CAACF,OAAO,CAAC,yCAAD,CAAR,CAAvC;;AAEA,IAAIgB,2BAA2B,GAAGd,sBAAsB,CAACF,OAAO,CAAC,0DAAD,CAAR,CAAxD;;AAEA,IAAIiB,gBAAgB,GAAGf,sBAAsB,CAACF,OAAO,CAAC,+CAAD,CAAR,CAA7C;;AAEA,IAAIkB,gBAAgB,GAAGhB,sBAAsB,CAACF,OAAO,CAAC,+CAAD,CAAR,CAA7C;;AAEA,IAAImB,gBAAgB,GAAGjB,sBAAsB,CAACF,OAAO,CAAC,+CAAD,CAAR,CAA7C;;AAEA,IAAIoB,aAAa,GAAGlB,sBAAsB,CAACF,OAAO,CAAC,4CAAD,CAAR,CAA1C;;AAEA,IAAIqB,QAAQ,GAAGnB,sBAAsB,CAACF,OAAO,CAAC,sDAAD,CAAR,CAArC;;AAEA,IAAIsB,OAAO,GAAGpB,sBAAsB,CAACF,OAAO,CAAC,uDAAD,CAAR,CAApC;;AAEA,IAAIuB,QAAQ,GAAGrB,sBAAsB,CAACF,OAAO,CAAC,yDAAD,CAAR,CAArC;;AAEA,IAAIwB,QAAQ,GAAGtB,sBAAsB,CAACF,OAAO,CAAC,yDAAD,CAAR,CAArC;;AAEA,IAAIyB,OAAO,GAAGvB,sBAAsB,CAACF,OAAO,CAAC,uDAAD,CAAR,CAApC;;AAEA,IAAI0B,IAAI,GAAGxB,sBAAsB,CAACF,OAAO,CAAC,oDAAD,CAAR,CAAjC;;AAEA,IAAI2B,oBAAoB,GAAGzB,sBAAsB,CAACF,OAAO,CAAC,uBAAD,CAAR,CAAjD;;AAEA,IAAI4B,OAAO,GAAG1B,sBAAsB,CAACF,OAAO,CAAC,UAAD,CAAR,CAApC;;AAEA,IAAI6B,OAAO,GAAG3B,sBAAsB,CAACF,OAAO,CAAC,UAAD,CAAR,CAApC;;AAEA,IAAI8B,YAAY,GAAG5B,sBAAsB,CAACF,OAAO,CAAC,eAAD,CAAR,CAAzC;;AAEA,IAAI+B,cAAc,GAAG7B,sBAAsB,CAACF,OAAO,CAAC,iBAAD,CAAR,CAA3C;;AAEA,IAAIgC,OAAO,GAAG9B,sBAAsB,CAACF,OAAO,CAAC,UAAD,CAAR,CAApC;;AAEA,SAASiC,YAAT,CAAsBC,OAAtB,EAA+B;EAC7B,IAAIC,yBAAyB,GAAGC,yBAAyB,EAAzD;;EAEA,OAAO,YAAY;IACjB,IAAIC,KAAK,GAAG,CAAC,GAAGpB,gBAAgB,CAACqB,OAArB,EAA8BJ,OAA9B,CAAZ;IAAA,IACIK,MADJ;;IAGA,IAAIJ,yBAAJ,EAA+B;MAC7B,IAAIK,SAAS,GAAG,CAAC,GAAGvB,gBAAgB,CAACqB,OAArB,EAA8B,IAA9B,EAAoCG,WAApD;MACAF,MAAM,GAAGxC,kBAAkB,CAACsC,KAAD,EAAQK,SAAR,EAAmBF,SAAnB,CAA3B;IACD,CAHD,MAGO;MACLD,MAAM,GAAGF,KAAK,CAACM,KAAN,CAAY,IAAZ,EAAkBD,SAAlB,CAAT;IACD;;IAED,OAAO,CAAC,GAAG1B,2BAA2B,CAACsB,OAAhC,EAAyC,IAAzC,EAA+CC,MAA/C,CAAP;EACD,CAZD;AAaD;;AAED,SAASH,yBAAT,GAAqC;EACnC,IAAI,OAAOQ,OAAP,KAAmB,WAAnB,IAAkC,CAAC7C,kBAAvC,EAA2D,OAAO,KAAP;EAC3D,IAAIA,kBAAkB,CAAC8C,IAAvB,EAA6B,OAAO,KAAP;EAC7B,IAAI,OAAOC,KAAP,KAAiB,UAArB,EAAiC,OAAO,IAAP;;EAEjC,IAAI;IACFC,OAAO,CAACC,SAAR,CAAkBC,OAAlB,CAA0BC,IAA1B,CAA+BnD,kBAAkB,CAACgD,OAAD,EAAU,EAAV,EAAc,YAAY,CAAE,CAA5B,CAAjD;IACA,OAAO,IAAP;EACD,CAHD,CAGE,OAAOI,CAAP,EAAU;IACV,OAAO,KAAP;EACD;AACF;;AAED,SAAStC,UAAT,CAAoBuC;AACpB;AADA;AAGA;AACA;EACE,IAAI,CAACA,IAAD,IAAS,CAACA,IAAI,CAACC,IAAnB,EAAyB;IACvB,OAAO,IAAP;EACD;;EAED,QAAQD,IAAI,CAACC,IAAb;IACE,KAAK,QAAL;MACE,OAAO,IAAIhD,OAAJ,EAAP;;IAEF,KAAK,WAAL;MACE,OAAO,IAAIK,WAAJ,CAAgB0C,IAAI,CAACE,MAArB,CAAP;;IAEF,KAAK,KAAL;MACE,OAAO,IAAI1C,KAAJ,CAAU,CAAC,GAAGgB,OAAO,CAACU,OAAZ,EAAqBc,IAAI,CAACG,OAA1B,CAAV,CAAP;;IAEF,KAAK,WAAL;MACE,OAAO,IAAI5C,WAAJ,CAAgB,CAAC,GAAGiB,OAAO,CAACU,OAAZ,EAAqBc,IAAI,CAACG,OAA1B,CAAhB,CAAP;;IAEF,KAAK,QAAL;MACE,OAAO,IAAIhD,QAAJ,CAAa,CAAC,GAAGqB,OAAO,CAACU,OAAZ,EAAqBc,IAAI,CAACG,OAA1B,CAAb,CAAP;;IAEF,KAAK,aAAL;MACE;QACE,IAAIC,KAAK,GAAG,CAAC,GAAG5B,OAAO,CAACU,OAAZ,EAAqBc,IAAI,CAACG,OAA1B,CAAZ;;QAEA,IAAI,CAAC,CAAC,GAAGlC,QAAQ,CAACiB,OAAb,EAAsBkB,KAAtB,CAAL,EAAmC;UACjC,OAAO,IAAIhD,UAAJ,CAAe,EAAf,EAAmB,EAAnB,CAAP;QACD;;QAED,OAAO,IAAIA,UAAJ,CAAegD,KAAf,EAAsB,EAAtB,CAAP;MACD;;IAEH,KAAK,gBAAL;MACE;QACE,IAAIC,QAAQ,GAAG,CAAC,GAAG7B,OAAO,CAACU,OAAZ,EAAqBc,IAAI,CAACG,OAA1B,CAAf;;QAEA,IAAI,CAAC,CAAC,GAAGlC,QAAQ,CAACiB,OAAb,EAAsBmB,QAAtB,CAAL,EAAsC;UACpC,OAAO,IAAIjD,UAAJ,CAAe,EAAf,EAAmB,EAAnB,CAAP;QACD;;QAED,OAAO,IAAIA,UAAJ,CAAe,EAAf,EAAmBiD,QAAnB,CAAP;MACD;;IAEH,KAAK,OAAL;MACE;QACE,IAAIC,MAAM,GAAG,EAAb;QACA,IAAIC,SAAS,GAAG,EAAhB;;QAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGR,IAAI,CAACS,GAAL,CAASC,MAA7B,EAAqCF,CAAC,EAAtC,EAA0C;UACxC,IAAIR,IAAI,CAACS,GAAL,CAASD,CAAT,EAAYP,IAAZ,KAAqB,aAAzB,EAAwC;YACtCK,MAAM,GAAG,CAAC,GAAGpC,OAAO,CAACgB,OAAZ,EAAqBoB,MAArB,EAA6BR,IAA7B,CAAkCQ,MAAlC,EAA0C,CAAC,GAAG9B,OAAO,CAACU,OAAZ,EAAqBc,IAAI,CAACS,GAAL,CAASD,CAAT,EAAYL,OAAjC,CAA1C,CAAT;UACD,CAFD,MAEO,IAAIH,IAAI,CAACS,GAAL,CAASD,CAAT,EAAYP,IAAZ,KAAqB,gBAAzB,EAA2C;YAChDM,SAAS,GAAG,CAAC,GAAGrC,OAAO,CAACgB,OAAZ,EAAqBqB,SAArB,EAAgCT,IAAhC,CAAqCS,SAArC,EAAgD,CAAC,GAAG/B,OAAO,CAACU,OAAZ,EAAqBc,IAAI,CAACS,GAAL,CAASD,CAAT,EAAYL,OAAjC,CAAhD,CAAZ;UACD;QACF;;QAED,OAAO,IAAI/C,UAAJ,CAAekD,MAAf,EAAuBC,SAAvB,CAAP;MACD;;IAEH;MACE,OAAO,IAAP;EAvDJ;AAyDD;;AAED,IAAIlD,EAAE,GAAG,aAAa,YAAY;EAChC,SAASA,EAAT,GAAc;IACZ,CAAC,GAAGU,gBAAgB,CAACmB,OAArB,EAA8B,IAA9B,EAAoC7B,EAApC;EACD;;EAED,CAAC,GAAGW,aAAa,CAACkB,OAAlB,EAA2B7B,EAA3B,EAA+B,CAAC;IAC9BsD,GAAG,EAAE,SADyB;IAE9B3D,KAAK,EAAE;IACP;IACA;IACA,CAAE;IACF;;EAN8B,CAAD,EAQ5B;IACD2D,GAAG,EAAE,WADJ;IAED3D,KAAK,EAAE;IACP;IACA,CAAE;IACF;;EALC,CAR4B,EAe5B;IACD2D,GAAG,EAAE,QADJ;IAED3D,KAAK,EAAE;IACP;IACA,CAAE;EAJD,CAf4B,CAA/B;EAqBA,OAAOK,EAAP;AACD,CA3BqB,EAAtB;;AA6BAN,OAAO,CAACM,EAAR,GAAaA,EAAb;;AAEA,IAAIH,KAAK,GAAG,aAAa,UAAU0D,GAAV,EAAe;EACtC,CAAC,GAAGjD,UAAU,CAACuB,OAAf,EAAwBhC,KAAxB,EAA+B0D,GAA/B;;EAEA,IAAIC,MAAM,GAAGhC,YAAY,CAAC3B,KAAD,CAAzB;;EAEA,SAASA,KAAT,CAAeF;EACf;EADA,EAEE;IACA,IAAI8D,KAAJ;;IAEA,CAAC,GAAG/C,gBAAgB,CAACmB,OAArB,EAA8B,IAA9B,EAAoChC,KAApC;IACA4D,KAAK,GAAGD,MAAM,CAACf,IAAP,CAAY,IAAZ,CAAR;IACA,CAAC,GAAGhC,gBAAgB,CAACoB,OAArB,EAA8B,CAAC,GAAGxB,uBAAuB,CAACwB,OAA5B,EAAqC4B,KAArC,CAA9B,EAA2E,QAA3E,EAAqF,KAAK,CAA1F;IACAA,KAAK,CAACC,MAAN,GAAe/D,KAAf;IACA,OAAO8D,KAAP;EACD;;EAED,CAAC,GAAG9C,aAAa,CAACkB,OAAlB,EAA2BhC,KAA3B,EAAkC,CAAC;IACjCyD,GAAG,EAAE,SAD4B;IAEjC3D,KAAK,EAAE;IACP;IACA;MACE,OAAO,KAAK+D,MAAZ;IACD;EANgC,CAAD,EAO/B;IACDJ,GAAG,EAAE,WADJ;IAED3D,KAAK,EAAE;IACP;IACA;MACE,OAAO,IAAIE,KAAJ,CAAU,KAAK6D,MAAf,CAAP;IACD;EANA,CAP+B,EAc/B;IACDJ,GAAG,EAAE,QADJ;IAED3D,KAAK,EAAE,UAAUgE;IACjB;IADO,EAEL;MACA,OAAO,CAAC,GAAGvC,OAAO,CAACS,OAAZ,EAAqB,KAAK6B,MAA1B,EAAkC,KAAlC,EAAyC,IAAzC,EAA+CE,SAA/C,EAA0DD,OAA1D,CAAP;IACD;EANA,CAd+B,CAAlC;EAsBA,OAAO9D,KAAP;AACD,CAxCwB,CAwCvBG,EAxCuB,CAAzB;;AA0CAN,OAAO,CAACG,KAAR,GAAgBA,KAAhB;;AAEA,IAAID,OAAO,GAAG,aAAa,UAAUiE,IAAV,EAAgB;EACzC,CAAC,GAAGvD,UAAU,CAACuB,OAAf,EAAwBjC,OAAxB,EAAiCiE,IAAjC;;EAEA,IAAIC,OAAO,GAAGtC,YAAY,CAAC5B,OAAD,CAA1B;;EAEA,SAASA,OAAT,GAAmB;IACjB,CAAC,GAAGc,gBAAgB,CAACmB,OAArB,EAA8B,IAA9B,EAAoCjC,OAApC;IACA,OAAOkE,OAAO,CAAC5B,KAAR,CAAc,IAAd,EAAoBD,SAApB,CAAP;EACD;;EAED,CAAC,GAAGtB,aAAa,CAACkB,OAAlB,EAA2BjC,OAA3B,EAAoC,CAAC;IACnC0D,GAAG,EAAE,SAD8B;IAEnC3D,KAAK,EAAE,YAAY;MACjB,OAAOiE,SAAP;IACD;EAJkC,CAAD,EAKjC;IACDN,GAAG,EAAE,WADJ;IAED3D,KAAK,EAAE;IACP;IACA;MACE,OAAO,IAAIC,OAAJ,EAAP;IACD;EANA,CALiC,EAYjC;IACD0D,GAAG,EAAE,QADJ;IAED3D,KAAK,EAAE;IACP;IACA;MACE,OAAO;QACLiD,IAAI,EAAE;MADD,CAAP;IAGD;EARA,CAZiC,CAApC;EAsBA,OAAOhD,OAAP;AACD,CAjC0B,CAiCzBI,EAjCyB,CAA3B;;AAmCAN,OAAO,CAACE,OAAR,GAAkBA,OAAlB;;AAEA,IAAIK,WAAW,GAAG,aAAa,UAAU8D,IAAV,EAAgB;EAC7C,CAAC,GAAGzD,UAAU,CAACuB,OAAf,EAAwB5B,WAAxB,EAAqC8D,IAArC;;EAEA,IAAIC,OAAO,GAAGxC,YAAY,CAACvB,WAAD,CAA1B;;EAEA,SAASA,WAAT,CAAqB4C;EACrB;EADA,EAEE;IACA,IAAIoB,MAAJ;;IAEA,CAAC,GAAGvD,gBAAgB,CAACmB,OAArB,EAA8B,IAA9B,EAAoC5B,WAApC;IACAgE,MAAM,GAAGD,OAAO,CAACvB,IAAR,CAAa,IAAb,CAAT;IACA,CAAC,GAAGhC,gBAAgB,CAACoB,OAArB,EAA8B,CAAC,GAAGxB,uBAAuB,CAACwB,OAA5B,EAAqCoC,MAArC,CAA9B,EAA4E,SAA5E,EAAuF,KAAK,CAA5F;;IAEA,IAAI,OAAOpB,MAAP,KAAkB,QAAtB,EAAgC;MAC9B,MAAM,IAAIqB,SAAJ,CAAc,yDAAd,CAAN;IACD;;IAEDD,MAAM,CAACE,OAAP,GAAiBtB,MAAjB;IACA,OAAOoB,MAAP;EACD;;EAED,CAAC,GAAGtD,aAAa,CAACkB,OAAlB,EAA2B5B,WAA3B,EAAwC,CAAC;IACvCqD,GAAG,EAAE,SADkC;IAEvC3D,KAAK,EAAE,UAAUA;IACjB;IADO;IAGP;IACA;MACE,IAAI,OAAOA,KAAP,KAAiB,WAArB,EAAkC;QAChC,OAAO,KAAKwE,OAAZ;MACD;;MAED,IAAI,OAAOxE,KAAP,KAAiB,QAArB,EAA+B;QAC7B,MAAM,IAAIuE,SAAJ,CAAc,uCAAd,CAAN;MACD;;MAED,OAAO,KAAKC,OAAL,GAAexE,KAAtB;IACD;EAhBsC,CAAD,EAiBrC;IACD2D,GAAG,EAAE,WADJ;IAED3D,KAAK,EAAE,UAAUyE;IACjB;IADO;IAGP;IACA;MACE,IAAI,CAACA,QAAL,EAAe;QACb,OAAO,IAAP;MACD;;MAED,IAAIA,QAAQ,YAAYvE,KAAxB,EAA+B;QAC7B,OAAO,IAAIA,KAAJ,CAAU,KAAKwE,OAAL,CAAaD,QAAQ,CAACV,MAAtB,CAAV,CAAP;MACD;;MAED,IAAIU,QAAQ,YAAYxE,OAAxB,EAAiC;QAC/B,OAAO,IAAIC,KAAJ,CAAU,KAAKsE,OAAf,CAAP;MACD;;MAED,IAAIC,QAAQ,YAAYnE,WAAxB,EAAqC;QACnC,OAAO,IAAIA,WAAJ,CAAgB,KAAKoE,OAAL,CAAaD,QAAQ,CAACD,OAAtB,CAAhB,CAAP;MACD;;MAED,MAAM,IAAIG,KAAJ,CAAU,gDAAV,CAAN;IACD;EAxBA,CAjBqC,EA0CrC;IACDhB,GAAG,EAAE,QADJ;IAED3D,KAAK,EAAE;IACP;IACA;MACE,OAAO;QACLiD,IAAI,EAAE,WADD;QAELC,MAAM,EAAE,KAAKsB;MAFR,CAAP;IAID;EATA,CA1CqC,CAAxC;EAqDA,OAAOlE,WAAP;AACD,CA5E8B,CA4E7BD,EA5E6B,CAA/B;;AA8EAN,OAAO,CAACO,WAAR,GAAsBA,WAAtB;;AAEA,IAAIE,KAAK,GAAG,aAAa,UAAUoE,IAAV,EAAgB;EACvC,CAAC,GAAGjE,UAAU,CAACuB,OAAf,EAAwB1B,KAAxB,EAA+BoE,IAA/B;;EAEA,IAAIC,OAAO,GAAGhD,YAAY,CAACrB,KAAD,CAA1B;;EAEA,SAASA,KAAT,CAAeR;EACf;EADA,EAEE;IACA,IAAI8E,MAAJ;;IAEA,CAAC,GAAG/D,gBAAgB,CAACmB,OAArB,EAA8B,IAA9B,EAAoC1B,KAApC;IACAsE,MAAM,GAAGD,OAAO,CAAC/B,IAAR,CAAa,IAAb,CAAT;IACA,CAAC,GAAGhC,gBAAgB,CAACoB,OAArB,EAA8B,CAAC,GAAGxB,uBAAuB,CAACwB,OAA5B,EAAqC4C,MAArC,CAA9B,EAA4E,QAA5E,EAAsF,KAAK,CAA3F;IACAA,MAAM,CAACf,MAAP,GAAgB,CAAC,GAAG9C,QAAQ,CAACiB,OAAb,EAAsBlC,KAAtB,IAA+BA,KAA/B,GAAuC,CAACA,KAAD,CAAvD;IACA,OAAO8E,MAAP;EACD;;EAED,CAAC,GAAG9D,aAAa,CAACkB,OAAlB,EAA2B1B,KAA3B,EAAkC,CAAC;IACjCmD,GAAG,EAAE,SAD4B;IAEjC3D,KAAK,EAAE,UAAUA;IACjB;IADO;IAGP;IACA;MACE,IAAIA,KAAK,IAAI,IAAb,EAAmB;QACjB,OAAO,KAAK+D,MAAZ;MACD;;MAED,IAAI,CAAC,GAAG9C,QAAQ,CAACiB,OAAb,EAAsBlC,KAAtB,CAAJ,EAAkC;QAChC,OAAO,CAAC,GAAGkB,OAAO,CAACgB,OAAZ,EAAqBlC,KAArB,EAA4B8C,IAA5B,CAAiC9C,KAAjC,EAAwC,KAAK+D,MAA7C,CAAP;MACD;;MAED,MAAM,IAAIY,KAAJ,CAAU,0CAAV,CAAN;IACD;EAhBgC,CAAD,EAiB/B;IACDhB,GAAG,EAAE,WADJ;IAED3D,KAAK,EAAE,UAAUyE;IACjB;IADO;IAGP;IACA;MACE,IAAI,CAACA,QAAL,EAAe;QACb,OAAO,IAAP;MACD;;MAED,IAAIA,QAAQ,YAAYvE,KAAxB,EAA+B;QAC7B,OAAO,IAAIA,KAAJ,CAAU,KAAKwE,OAAL,CAAaD,QAAQ,CAACV,MAAtB,CAAV,CAAP;MACD;;MAED,IAAIU,QAAQ,YAAYxE,OAAxB,EAAiC;QAC/B,OAAO,IAAIC,KAAJ,CAAU,KAAK6D,MAAf,CAAP;MACD;;MAED,IAAIU,QAAQ,YAAYjE,KAAxB,EAA+B;QAC7B,OAAO,IAAIA,KAAJ,CAAU,KAAKkE,OAAL,CAAaD,QAAQ,CAACV,MAAtB,CAAV,CAAP;MACD;;MAED,MAAM,IAAIY,KAAJ,CAAU,0CAAV,CAAN;IACD;EAxBA,CAjB+B,EA0C/B;IACDhB,GAAG,EAAE,QADJ;IAED3D,KAAK,EAAE;IACP;IACA;MACE,OAAO;QACLiD,IAAI,EAAE,KADD;QAELE,OAAO,EAAE,CAAC,GAAG1B,OAAO,CAACS,OAAZ,EAAqB,KAAK6B,MAA1B,EAAkC,KAAlC,EAAyC,IAAzC;MAFJ,CAAP;IAID;EATA,CA1C+B,CAAlC;EAqDA,OAAOvD,KAAP;AACD,CAvEwB,CAuEvBH,EAvEuB,CAAzB;;AAyEAN,OAAO,CAACS,KAAR,GAAgBA,KAAhB;;AAEA,IAAID,WAAW,GAAG,aAAa,UAAUwE,IAAV,EAAgB;EAC7C,CAAC,GAAGpE,UAAU,CAACuB,OAAf,EAAwB3B,WAAxB,EAAqCwE,IAArC;;EAEA,IAAIC,OAAO,GAAGnD,YAAY,CAACtB,WAAD,CAA1B;;EAEA,SAASA,WAAT,CAAqBP;EACrB;EADA,EAEE;IACA,IAAIiF,MAAJ;;IAEA,CAAC,GAAGlE,gBAAgB,CAACmB,OAArB,EAA8B,IAA9B,EAAoC3B,WAApC;IACA0E,MAAM,GAAGD,OAAO,CAAClC,IAAR,CAAa,IAAb,CAAT;IACA,CAAC,GAAGhC,gBAAgB,CAACoB,OAArB,EAA8B,CAAC,GAAGxB,uBAAuB,CAACwB,OAA5B,EAAqC+C,MAArC,CAA9B,EAA4E,QAA5E,EAAsF,KAAK,CAA3F;IACAA,MAAM,CAAClB,MAAP,GAAgB,CAAC,GAAGnC,OAAO,CAACM,OAAZ,EAAqB,CAAC,GAAGjB,QAAQ,CAACiB,OAAb,EAAsBlC,KAAtB,IAA+BA,KAA/B,GAAuC,CAACA,KAAD,CAA5D,CAAhB;IACA,OAAOiF,MAAP;EACD;;EAED,CAAC,GAAGjE,aAAa,CAACkB,OAAlB,EAA2B3B,WAA3B,EAAwC,CAAC;IACvCoD,GAAG,EAAE,SADkC;IAEvC3D,KAAK,EAAE,UAAUA;IACjB;IADO;IAGP;IACA;MACE,IAAIA,KAAK,IAAI,IAAb,EAAmB;QACjB,OAAO,KAAK+D,MAAL,IAAe,EAAtB;MACD;;MAED,IAAI,CAAC,GAAG9C,QAAQ,CAACiB,OAAb,EAAsBlC,KAAtB,CAAJ,EAAkC;QAChC,IAAIkF,QAAJ;;QAEA,IAAI9B,KAAK,GAAG,EAAZ;QACA,CAAC,GAAGjC,QAAQ,CAACe,OAAb,EAAsBgD,QAAQ,GAAG,KAAKnB,MAAtC,EAA8CjB,IAA9C,CAAmDoC,QAAnD,EAA6D,UAAUC,CAAV,EAAa;UACxE,IAAIA,CAAC,YAAYzD,YAAY,CAACQ,OAA9B,EAAuC;YACrC,IAAI,CAAC,CAAC,GAAGX,oBAAoB,CAACW,OAAzB,EAAkClC,KAAlC,EAAyCmF,CAAzC,CAAL,EAAkD;cAChD/B,KAAK,CAACgC,IAAN,CAAWD,CAAX;YACD;UACF,CAJD,MAIO;YACL,IAAI,CAAC,GAAG/D,QAAQ,CAACc,OAAb,EAAsBlC,KAAtB,EAA6B8C,IAA7B,CAAkC9C,KAAlC,EAAyCmF,CAAzC,IAA8C,CAAlD,EAAqD;cACnD/B,KAAK,CAACgC,IAAN,CAAWD,CAAX;YACD;UACF;QACF,CAVD;QAWA,OAAO,CAAC,GAAGjE,OAAO,CAACgB,OAAZ,EAAqBlC,KAArB,EAA4B8C,IAA5B,CAAiC9C,KAAjC,EAAwCoD,KAAxC,CAAP;MACD;;MAED,MAAM,IAAIuB,KAAJ,CAAU,0CAAV,CAAN;IACD;EA9BsC,CAAD,EA+BrC;IACDhB,GAAG,EAAE,WADJ;IAED3D,KAAK,EAAE,UAAUyE;IACjB;IADO;IAGP;IACA;MACE,IAAI,CAACA,QAAL,EAAe;QACb,OAAO,IAAP;MACD;;MAED,IAAIA,QAAQ,YAAYvE,KAAxB,EAA+B;QAC7B,OAAO,IAAIA,KAAJ,CAAU,KAAKwE,OAAL,CAAaD,QAAQ,CAACV,MAAtB,CAAV,CAAP;MACD;;MAED,IAAIU,QAAQ,YAAYxE,OAAxB,EAAiC;QAC/B,OAAO,IAAIC,KAAJ,CAAU,KAAK6D,MAAf,CAAP;MACD;;MAED,IAAIU,QAAQ,YAAYlE,WAAxB,EAAqC;QACnC,OAAO,IAAIA,WAAJ,CAAgB,KAAKmE,OAAL,CAAaD,QAAQ,CAACV,MAAtB,CAAhB,CAAP;MACD;;MAED,MAAM,IAAIY,KAAJ,CAAU,gDAAV,CAAN;IACD;EAxBA,CA/BqC,EAwDrC;IACDhB,GAAG,EAAE,QADJ;IAED3D,KAAK,EAAE;IACP;IACA;MACE,OAAO;QACLiD,IAAI,EAAE,WADD;QAELE,OAAO,EAAE,CAAC,GAAG1B,OAAO,CAACS,OAAZ,EAAqB,KAAK6B,MAA1B,EAAkC,KAAlC,EAAyC,IAAzC;MAFJ,CAAP;IAID;EATA,CAxDqC,CAAxC;EAmEA,OAAOxD,WAAP;AACD,CArF8B,CAqF7BF,EArF6B,CAA/B;;AAuFAN,OAAO,CAACQ,WAAR,GAAsBA,WAAtB;;AAEA,IAAIJ,QAAQ,GAAG,aAAa,UAAUkF,IAAV,EAAgB;EAC1C,CAAC,GAAG1E,UAAU,CAACuB,OAAf,EAAwB/B,QAAxB,EAAkCkF,IAAlC;;EAEA,IAAIC,OAAO,GAAGzD,YAAY,CAAC1B,QAAD,CAA1B;;EAEA,SAASA,QAAT,CAAkBH;EAClB;EADA,EAEE;IACA,IAAIuF,MAAJ;;IAEA,CAAC,GAAGxE,gBAAgB,CAACmB,OAArB,EAA8B,IAA9B,EAAoC/B,QAApC;IACAoF,MAAM,GAAGD,OAAO,CAACxC,IAAR,CAAa,IAAb,CAAT;IACA,CAAC,GAAGhC,gBAAgB,CAACoB,OAArB,EAA8B,CAAC,GAAGxB,uBAAuB,CAACwB,OAA5B,EAAqCqD,MAArC,CAA9B,EAA4E,QAA5E,EAAsF,KAAK,CAA3F;IACAA,MAAM,CAACxB,MAAP,GAAgB,CAAC,GAAGnC,OAAO,CAACM,OAAZ,EAAqB,CAAC,GAAGjB,QAAQ,CAACiB,OAAb,EAAsBlC,KAAtB,IAA+BA,KAA/B,GAAuC,CAACA,KAAD,CAA5D,CAAhB;IACA,OAAOuF,MAAP;EACD;;EAED,CAAC,GAAGvE,aAAa,CAACkB,OAAlB,EAA2B/B,QAA3B,EAAqC,CAAC;IACpCwD,GAAG,EAAE,SAD+B;IAEpC3D,KAAK,EAAE,UAAUA;IACjB;IADO;IAGP;IACA;MACE,IAAIA,KAAK,IAAI,IAAb,EAAmB;QACjB,OAAO,EAAP;MACD;;MAED,IAAI,CAAC,GAAGiB,QAAQ,CAACiB,OAAb,EAAsBlC,KAAtB,CAAJ,EAAkC;QAChC;QACA,IAAIwF,OAAO,GAAG,CAAC,GAAGtE,OAAO,CAACgB,OAAZ,EAAqBlC,KAArB,EAA4B8C,IAA5B,CAAiC9C,KAAjC,EAAwC,EAAxC,CAAd;;QAEA,KAAK,IAAIwD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKO,MAAL,CAAYL,MAAhC,EAAwCF,CAAC,EAAzC,EAA6C;UAC3C,IAAIiC,KAAK,GAAG,CAAC,GAAGrE,QAAQ,CAACc,OAAb,EAAsBsD,OAAtB,EAA+B1C,IAA/B,CAAoC0C,OAApC,EAA6C,KAAKzB,MAAL,CAAYP,CAAZ,CAA7C,CAAZ;;UAEA,OAAOiC,KAAK,GAAG,CAAC,CAAhB,EAAmB;YACjB,CAAC,GAAGpE,OAAO,CAACa,OAAZ,EAAqBsD,OAArB,EAA8B1C,IAA9B,CAAmC0C,OAAnC,EAA4CC,KAA5C,EAAmD,CAAnD;YACAA,KAAK,GAAG,CAAC,GAAGrE,QAAQ,CAACc,OAAb,EAAsBsD,OAAtB,EAA+B1C,IAA/B,CAAoC0C,OAApC,EAA6C,KAAKzB,MAAL,CAAYP,CAAZ,CAA7C,CAAR;UACD;;UAED,IAAI,KAAKO,MAAL,CAAYP,CAAZ,aAA0B9B,YAAY,CAACQ,OAAvC,IAAkD,KAAK6B,MAAL,CAAYP,CAAZ,EAAekC,EAArE,EAAyE;YACvE,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,OAAO,CAAC9B,MAA5B,EAAoCiC,CAAC,EAArC,EAAyC;cACvC,IAAIH,OAAO,CAACG,CAAD,CAAP,YAAsBjE,YAAY,CAACQ,OAAnC,IAA8C,KAAK6B,MAAL,CAAYP,CAAZ,EAAekC,EAAf,KAAsBF,OAAO,CAACG,CAAD,CAAP,CAAWD,EAAnF,EAAuF;gBACrF,CAAC,GAAGrE,OAAO,CAACa,OAAZ,EAAqBsD,OAArB,EAA8B1C,IAA9B,CAAmC0C,OAAnC,EAA4CG,CAA5C,EAA+C,CAA/C;gBACAA,CAAC;cACF;YACF;UACF;QACF;;QAED,OAAOH,OAAP;MACD;;MAED,MAAM,IAAIb,KAAJ,CAAU,+CAAV,CAAN;IACD;EArCmC,CAAD,EAsClC;IACDhB,GAAG,EAAE,WADJ;IAED3D,KAAK,EAAE,UAAUyE;IACjB;IADO;IAGP;IACA;MACE,IAAI,CAACA,QAAL,EAAe;QACb,OAAO,IAAP;MACD;;MAED,IAAIA,QAAQ,YAAYvE,KAAxB,EAA+B;QAC7B,OAAO,IAAIA,KAAJ,CAAU,KAAKwE,OAAL,CAAaD,QAAQ,CAACV,MAAtB,CAAV,CAAP;MACD;;MAED,IAAIU,QAAQ,YAAYxE,OAAxB,EAAiC;QAC/B,OAAO,IAAIA,OAAJ,EAAP;MACD;;MAED,IAAIwE,QAAQ,YAAYtE,QAAxB,EAAkC;QAChC,IAAIyF,SAAJ;;QAEA,IAAIC,OAAO,GAAG,CAAC,GAAG3E,OAAO,CAACgB,OAAZ,EAAqB0D,SAAS,GAAGnB,QAAQ,CAACV,MAA1C,EAAkDjB,IAAlD,CAAuD8C,SAAvD,EAAkE,EAAlE,CAAd;;QAEA,KAAK,IAAIpC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKO,MAAL,CAAYL,MAAhC,EAAwCF,CAAC,EAAzC,EAA6C;UAC3C,IAAI,KAAKO,MAAL,CAAYP,CAAZ,aAA0B9B,YAAY,CAACQ,OAA3C,EAAoD;YAClD,IAAI,CAAC,CAAC,GAAGX,oBAAoB,CAACW,OAAzB,EAAkC2D,OAAlC,EAA2C,KAAK9B,MAAL,CAAYP,CAAZ,CAA3C,CAAL,EAAiE;cAC/DqC,OAAO,CAACT,IAAR,CAAa,KAAKrB,MAAL,CAAYP,CAAZ,CAAb;YACD;UACF,CAJD,MAIO;YACL,IAAI,CAAC,GAAGpC,QAAQ,CAACc,OAAb,EAAsB2D,OAAtB,EAA+B/C,IAA/B,CAAoC+C,OAApC,EAA6C,KAAK9B,MAAL,CAAYP,CAAZ,CAA7C,IAA+D,CAAnE,EAAsE;cACpEqC,OAAO,CAACT,IAAR,CAAa,KAAKrB,MAAL,CAAYP,CAAZ,CAAb;YACD;UACF;QACF;;QAED,OAAO,IAAIrD,QAAJ,CAAa0F,OAAb,CAAP;MACD;;MAED,MAAM,IAAIlB,KAAJ,CAAU,6CAAV,CAAN;IACD;EAxCA,CAtCkC,EA+ElC;IACDhB,GAAG,EAAE,QADJ;IAED3D,KAAK,EAAE;IACP;IACA;MACE,OAAO;QACLiD,IAAI,EAAE,QADD;QAELE,OAAO,EAAE,CAAC,GAAG1B,OAAO,CAACS,OAAZ,EAAqB,KAAK6B,MAA1B,EAAkC,KAAlC,EAAyC,IAAzC;MAFJ,CAAP;IAID;EATA,CA/EkC,CAArC;EA0FA,OAAO5D,QAAP;AACD,CA5G2B,CA4G1BE,EA5G0B,CAA5B;;AA8GAN,OAAO,CAACI,QAAR,GAAmBA,QAAnB;;AAEA,IAAIC,UAAU,GAAG,aAAa,UAAU0F,IAAV,EAAgB;EAC5C,CAAC,GAAGnF,UAAU,CAACuB,OAAf,EAAwB9B,UAAxB,EAAoC0F,IAApC;;EAEA,IAAIC,OAAO,GAAGlE,YAAY,CAACzB,UAAD,CAA1B;;EAEA,SAASA,UAAT,CAAoB4F;EACpB;EADA,EAEEC;EACF;EAHA,EAIE;IACA,IAAIC,MAAJ;;IAEA,CAAC,GAAGnF,gBAAgB,CAACmB,OAArB,EAA8B,IAA9B,EAAoC9B,UAApC;IACA8F,MAAM,GAAGH,OAAO,CAACjD,IAAR,CAAa,IAAb,CAAT;IACA,CAAC,GAAGhC,gBAAgB,CAACoB,OAArB,EAA8B,CAAC,GAAGxB,uBAAuB,CAACwB,OAA5B,EAAqCgE,MAArC,CAA9B,EAA4E,kBAA5E,EAAgG,KAAK,CAArG;IACA,CAAC,GAAGpF,gBAAgB,CAACoB,OAArB,EAA8B,CAAC,GAAGxB,uBAAuB,CAACwB,OAA5B,EAAqCgE,MAArC,CAA9B,EAA4E,gBAA5E,EAA8F,KAAK,CAAnG;IACA,CAAC,GAAGpF,gBAAgB,CAACoB,OAArB,EAA8B,CAAC,GAAGxB,uBAAuB,CAACwB,OAA5B,EAAqCgE,MAArC,CAA9B,EAA4E,mBAA5E,EAAiG,KAAK,CAAtG;IACAA,MAAM,CAACC,gBAAP,GAA0B,IAA1B;;IAEA,IAAI,CAAC,GAAGlF,QAAQ,CAACiB,OAAb,EAAsB8D,IAAtB,CAAJ,EAAiC;MAC/BE,MAAM,CAACE,cAAP,GAAwB,CAAC,GAAGxE,OAAO,CAACM,OAAZ,EAAqB,CAAC,GAAGZ,IAAI,CAACY,OAAT,EAAkB8D,IAAlB,EAAwBlD,IAAxB,CAA6BkD,IAA7B,EAAmCE,MAAM,CAACG,UAA1C,EAAsD,CAAC,GAAG3F,uBAAuB,CAACwB,OAA5B,EAAqCgE,MAArC,CAAtD,CAArB,CAAxB;IACD;;IAED,IAAI,CAAC,GAAGjF,QAAQ,CAACiB,OAAb,EAAsB+D,OAAtB,CAAJ,EAAoC;MAClCC,MAAM,CAACI,iBAAP,GAA2B,CAAC,GAAG1E,OAAO,CAACM,OAAZ,EAAqB,CAAC,GAAGZ,IAAI,CAACY,OAAT,EAAkB+D,OAAlB,EAA2BnD,IAA3B,CAAgCmD,OAAhC,EAAyCC,MAAM,CAACG,UAAhD,EAA4D,CAAC,GAAG3F,uBAAuB,CAACwB,OAA5B,EAAqCgE,MAArC,CAA5D,CAArB,CAA3B;IACD;;IAED,OAAOA,MAAP;EACD;;EAED,CAAC,GAAGlF,aAAa,CAACkB,OAAlB,EAA2B9B,UAA3B,EAAuC,CAAC;IACtCuD,GAAG,EAAE,YADiC;IAEtC3D,KAAK,EAAE,UAAUuG;IACjB;IADO;IAGP;IACA;MACE,IAAI,OAAOA,GAAP,KAAe,QAAnB,EAA6B;QAC3B,OAAOA,GAAP;MACD;;MAED,IAAI,CAACA,GAAG,CAACb,EAAT,EAAa;QACX,MAAM,IAAIf,KAAJ,CAAU,kEAAV,CAAN;MACD;;MAED,IAAI,CAAC,KAAKwB,gBAAV,EAA4B;QAC1B,KAAKA,gBAAL,GAAwBI,GAAG,CAACC,SAA5B;MACD;;MAED,IAAI,KAAKL,gBAAL,KAA0BI,GAAG,CAACC,SAAlC,EAA6C;QAC3C,IAAIC,SAAJ;;QAEA,MAAM,IAAI9B,KAAJ,CAAU,CAAC,GAAGzD,OAAO,CAACgB,OAAZ,EAAqBuE,SAAS,GAAG,6DAA6DC,MAA7D,CAAoE,KAAKP,gBAAzE,EAA2F,OAA3F,CAAjC,EAAsIrD,IAAtI,CAA2I2D,SAA3I,EAAsJF,GAAG,CAACC,SAA1J,EAAqK,GAArK,CAAV,CAAN;MACD;;MAED,OAAOD,GAAG,CAACb,EAAX;IACD;EA1BqC,CAAD,EA2BpC;IACD/B,GAAG,EAAE,SADJ;IAED3D,KAAK,EAAE,UAAUA;IACjB;IADO,EAEL2G;IACF;IAHO,EAILhD;IACF;IALO;IAOP;IACA;MACE,IAAI,CAAC3D,KAAL,EAAY;QACV,IAAI4G,SAAJ;;QAEA,IAAI,CAACD,MAAD,IAAW,CAAChD,GAAhB,EAAqB;UACnB,MAAM,IAAIgB,KAAJ,CAAU,mFAAV,CAAN;QACD;;QAED,IAAIkC,MAAM,GAAG,IAAInF,YAAY,CAACQ,OAAjB,CAAyByE,MAAM,CAACH,SAAhC,CAAb;;QAEA,IAAIG,MAAM,CAACjB,EAAP,IAAa,CAAC,GAAGtE,QAAQ,CAACc,OAAb,EAAsB0E,SAAS,GAAGD,MAAM,CAACjB,EAAzC,EAA6C5C,IAA7C,CAAkD8D,SAAlD,EAA6D,OAA7D,MAA0E,CAA3F,EAA8F;UAC5FC,MAAM,CAACC,QAAP,GAAkBH,MAAM,CAACjB,EAAzB;QACD,CAFD,MAEO,IAAIiB,MAAM,CAACjB,EAAX,EAAe;UACpBmB,MAAM,CAACnB,EAAP,GAAYiB,MAAM,CAACjB,EAAnB;QACD;;QAED,IAAIqB,QAAQ,GAAG,IAAIpF,cAAc,CAACO,OAAnB,CAA2B2E,MAA3B,EAAmClD,GAAnC,CAAf;QACAoD,QAAQ,CAACC,eAAT,GAA2B,KAAKb,gBAAhC;QACA,OAAOY,QAAP;MACD;;MAED,IAAI/G,KAAK,YAAY2B,cAAc,CAACO,OAApC,EAA6C;QAC3C,IAAI,KAAKiE,gBAAT,EAA2B;UACzB,IAAInG,KAAK,CAACgH,eAAV,EAA2B;YACzB,IAAI,KAAKb,gBAAL,KAA0BnG,KAAK,CAACgH,eAApC,EAAqD;cACnD,IAAIC,SAAJ;;cAEA,MAAM,IAAItC,KAAJ,CAAU,CAAC,GAAGzD,OAAO,CAACgB,OAAZ,EAAqB+E,SAAS,GAAG,4BAA4BP,MAA5B,CAAmC1G,KAAK,CAACgH,eAAzC,EAA0D,UAA1D,CAAjC,EAAwGlE,IAAxG,CAA6GmE,SAA7G,EAAwH,KAAKd,gBAA7H,EAA+I,iBAA/I,CAAV,CAAN;YACD;UACF,CAND,MAMO;YACLnG,KAAK,CAACgH,eAAN,GAAwB,KAAKb,gBAA7B;UACD;QACF;;QAED,OAAOnG,KAAP;MACD;;MAED,MAAM,IAAI2E,KAAJ,CAAU,oDAAV,CAAN;IACD;EAhDA,CA3BoC,EA4EpC;IACDhB,GAAG,EAAE,WADJ;IAED3D,KAAK,EAAE,UAAUyE;IACjB;IADO;IAGP;IACA;MACE,IAAI,CAACA,QAAL,EAAe;QACb,OAAO,IAAP;MACD;;MAED,IAAIA,QAAQ,YAAYxE,OAAxB,EAAiC;QAC/B,MAAM,IAAI0E,KAAJ,CAAU,iDAAV,CAAN;MACD;;MAED,IAAIF,QAAQ,YAAYvE,KAApB,IAA6BuE,QAAQ,CAACV,MAAT,YAA2BpC,cAAc,CAACO,OAA3E,EAAoF;QAClF,OAAO,IAAP;MACD;;MAED,IAAIuC,QAAQ,YAAYrE,UAAxB,EAAoC;QAClC,IAAI8G,SAAJ,EAAeC,SAAf,EAA0BC,SAA1B,EAAqCC,UAArC,EAAiDC,UAAjD,EAA6DC,UAA7D;;QAEA,IAAI9C,QAAQ,CAAC0B,gBAAT,IAA6B1B,QAAQ,CAAC0B,gBAAT,KAA8B,KAAKA,gBAApE,EAAsF;UACpF,IAAIqB,SAAJ;;UAEA,MAAM,IAAI7C,KAAJ,CAAU,CAAC,GAAGzD,OAAO,CAACgB,OAAZ,EAAqBsF,SAAS,GAAG,mCAAmCd,MAAnC,CAA0CjC,QAAQ,CAAC0B,gBAAnD,EAAqE,QAArE,CAAjC,EAAiHrD,IAAjH,CAAsH0E,SAAtH,EAAiI,KAAKrB,gBAAL,IAAyB,MAA1J,EAAkK,iBAAlK,CAAV,CAAN;QACD;;QAED,IAAIsB,MAAM,GAAG,CAAC,GAAGvG,OAAO,CAACgB,OAAZ,EAAqBgF,SAAS,GAAGzC,QAAQ,CAAC2B,cAA1C,EAA0DtD,IAA1D,CAA+DoE,SAA/D,EAA0E,EAA1E,CAAb;QACA,CAAC,GAAG/F,QAAQ,CAACe,OAAb,EAAsBiF,SAAS,GAAG,KAAKb,iBAAvC,EAA0DxD,IAA1D,CAA+DqE,SAA/D,EAA0E,UAAUO,CAAV,EAAa;UACrF,IAAIjC,KAAK,GAAG,CAAC,GAAGrE,QAAQ,CAACc,OAAb,EAAsBuF,MAAtB,EAA8B3E,IAA9B,CAAmC2E,MAAnC,EAA2CC,CAA3C,CAAZ;;UAEA,IAAIjC,KAAK,GAAG,CAAC,CAAb,EAAgB;YACd,CAAC,GAAGpE,OAAO,CAACa,OAAZ,EAAqBuF,MAArB,EAA6B3E,IAA7B,CAAkC2E,MAAlC,EAA0ChC,KAA1C,EAAiD,CAAjD;UACD;QACF,CAND;QAOA,CAAC,GAAGtE,QAAQ,CAACe,OAAb,EAAsBkF,SAAS,GAAG,KAAKhB,cAAvC,EAAuDtD,IAAvD,CAA4DsE,SAA5D,EAAuE,UAAUM,CAAV,EAAa;UAClF,IAAIjC,KAAK,GAAG,CAAC,GAAGrE,QAAQ,CAACc,OAAb,EAAsBuF,MAAtB,EAA8B3E,IAA9B,CAAmC2E,MAAnC,EAA2CC,CAA3C,CAAZ;;UAEA,IAAIjC,KAAK,GAAG,CAAZ,EAAe;YACbgC,MAAM,CAACrC,IAAP,CAAYsC,CAAZ;UACD;QACF,CAND;QAOA,IAAIC,SAAS,GAAG,CAAC,GAAGzG,OAAO,CAACgB,OAAZ,EAAqBmF,UAAU,GAAG5C,QAAQ,CAAC6B,iBAA3C,EAA8DxD,IAA9D,CAAmEuE,UAAnE,EAA+E,EAA/E,CAAhB;QACA,CAAC,GAAGlG,QAAQ,CAACe,OAAb,EAAsBoF,UAAU,GAAG,KAAKlB,cAAxC,EAAwDtD,IAAxD,CAA6DwE,UAA7D,EAAyE,UAAUI,CAAV,EAAa;UACpF,IAAIjC,KAAK,GAAG,CAAC,GAAGrE,QAAQ,CAACc,OAAb,EAAsByF,SAAtB,EAAiC7E,IAAjC,CAAsC6E,SAAtC,EAAiDD,CAAjD,CAAZ;;UAEA,IAAIjC,KAAK,GAAG,CAAC,CAAb,EAAgB;YACd,CAAC,GAAGpE,OAAO,CAACa,OAAZ,EAAqByF,SAArB,EAAgC7E,IAAhC,CAAqC6E,SAArC,EAAgDlC,KAAhD,EAAuD,CAAvD;UACD;QACF,CAND;QAOA,CAAC,GAAGtE,QAAQ,CAACe,OAAb,EAAsBqF,UAAU,GAAG,KAAKjB,iBAAxC,EAA2DxD,IAA3D,CAAgEyE,UAAhE,EAA4E,UAAUG,CAAV,EAAa;UACvF,IAAIjC,KAAK,GAAG,CAAC,GAAGrE,QAAQ,CAACc,OAAb,EAAsByF,SAAtB,EAAiC7E,IAAjC,CAAsC6E,SAAtC,EAAiDD,CAAjD,CAAZ;;UAEA,IAAIjC,KAAK,GAAG,CAAZ,EAAe;YACbkC,SAAS,CAACvC,IAAV,CAAesC,CAAf;UACD;QACF,CAND;QAOA,IAAIE,WAAW,GAAG,IAAIxH,UAAJ,CAAeqH,MAAf,EAAuBE,SAAvB,CAAlB;QACAC,WAAW,CAACzB,gBAAZ,GAA+B,KAAKA,gBAApC;QACA,OAAOyB,WAAP;MACD;;MAED,MAAM,IAAIjD,KAAJ,CAAU,+CAAV,CAAN;IACD;EAhEA,CA5EoC,EA6IpC;IACDhB,GAAG,EAAE,QADJ;IAED3D,KAAK,EAAE;IACP;IACA;MACE,IAAI6H,MAAM,GAAG,IAAb;;MAEA,IAAIC,WAAW,GAAG,UAAUpC,EAAV,EAAc;QAC9B,OAAO;UACLqC,MAAM,EAAE,SADH;UAELvB,SAAS,EAAEqB,MAAM,CAAC1B,gBAFb;UAGL6B,QAAQ,EAAEtC;QAHL,CAAP;MAKD,CAND;;MAQA,IAAIM,IAAI,GAAG,IAAX;MACA,IAAIC,OAAO,GAAG,IAAd;MACA,IAAIgC,QAAQ,GAAG,IAAf;;MAEA,IAAI,KAAK7B,cAAL,CAAoB1C,MAApB,GAA6B,CAAjC,EAAoC;QAClC,IAAIwE,UAAJ;;QAEAD,QAAQ,GAAG,CAAC,GAAG3G,IAAI,CAACY,OAAT,EAAkBgG,UAAU,GAAG,KAAK9B,cAApC,EAAoDtD,IAApD,CAAyDoF,UAAzD,EAAqEJ,WAArE,CAAX;QACA9B,IAAI,GAAG;UACL/C,IAAI,EAAE,aADD;UAELE,OAAO,EAAE8E;QAFJ,CAAP;MAID;;MAED,IAAI,KAAK3B,iBAAL,CAAuB5C,MAAvB,GAAgC,CAApC,EAAuC;QACrC,IAAIyE,UAAJ;;QAEAF,QAAQ,GAAG,CAAC,GAAG3G,IAAI,CAACY,OAAT,EAAkBiG,UAAU,GAAG,KAAK7B,iBAApC,EAAuDxD,IAAvD,CAA4DqF,UAA5D,EAAwEL,WAAxE,CAAX;QACA7B,OAAO,GAAG;UACRhD,IAAI,EAAE,gBADE;UAERE,OAAO,EAAE8E;QAFD,CAAV;MAID;;MAED,IAAIjC,IAAI,IAAIC,OAAZ,EAAqB;QACnB,OAAO;UACLhD,IAAI,EAAE,OADD;UAELQ,GAAG,EAAE,CAACuC,IAAD,EAAOC,OAAP;QAFA,CAAP;MAID;;MAED,OAAOD,IAAI,IAAIC,OAAR,IAAmB,EAA1B;IACD;EA/CA,CA7IoC,CAAvC;EA8LA,OAAO7F,UAAP;AACD,CA7N6B,CA6N5BC,EA7N4B,CAA9B;;AA+NAN,OAAO,CAACK,UAAR,GAAqBA,UAArB"},"metadata":{},"sourceType":"script"}